<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>八年級數學(三) 4-3 完整複習卷</title>
    
    <script>
    window.MathJax = {
      tex: {
        inlineMath: [['$', '$'], ['\\(', '\\)']]
      }
    };
    </script>
    <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>

    <style>
        /* =========================================
           核心設定：國中教科書印刷風格
           ========================================= */
        :root {
            /* 字體堆疊 */
            --font-main: "Times New Roman", "PMingLiU", "MingLiU", "新細明體", "細明體", serif;
            --font-note: "BiauKai", "DFKai-SB", "標楷體", serif; /* 解析用標楷體 */
            
            /* 顏色變數 */
            --paper-bg: #ffffff;
            --text-color: #000000;
            --correct-color: #008000; /* 深綠 */
            --wrong-color: #cc0000;   /* 深紅 */
            --note-color: #d32f2f;    /* 批改紅字 */
            --btn-bg: #f5f5f5;
        }

        body {
            background-color: #555; /* 網頁背景深灰 */
            margin: 0;
            padding: 20px;
            font-family: var(--font-main);
            display: flex;
            justify-content: center;
        }

        .paper {
            background-color: var(--paper-bg);
            width: 100%;
            max-width: 900px; /* B4 寬度 */
            padding: 60px 70px; /* 寬裕留白 */
            box-shadow: 0 5px 15px rgba(0,0,0,0.3);
            min-height: 100vh;
            color: var(--text-color);
            line-height: 1.6;
            font-size: 18px;
        }

        /* 標題區 */
        header {
            text-align: center;
            border-bottom: 3px double #000;
            padding-bottom: 15px;
            margin-bottom: 30px;
        }
        h1 { font-size: 28px; margin: 0 0 10px 0; letter-spacing: 2px; }
        .subtitle { font-size: 16px; }

        /* 大題標題 */
        .section-header {
            font-size: 20px;
            font-weight: bold;
            margin-top: 40px;
            margin-bottom: 20px;
            padding-bottom: 5px;
            border-bottom: 1px solid #000;
        }

        /* =========================================
           通用題目結構
           ========================================= */
        .question-block {
            margin-bottom: 30px;
            break-inside: avoid;
        }

        .q-line {
            display: flex;
            align-items: baseline;
            margin-bottom: 10px;
        }

        .q-num {
            font-family: "Times New Roman", serif;
            font-weight: bold;
            margin-right: 8px;
            min-width: 25px;
        }

        .q-content { font-weight: normal; width: 100%; }

        /* 圖片容器 */
        .q-image-box {
            display: block;
            margin: 10px 0;
            padding: 10px;
            background-color: #f9f9f9;
            border: 2px dashed #ccc;
            text-align: center;
            color: #777;
            font-size: 14px;
        }
        
        .q-image-box img {
            max-width: 100%;
            max-height: 250px;
            display: block;
            margin: 0 auto;
        }

        /* =========================================
           [一、選擇題] 專用樣式
           ========================================= */
        .options-grid {
            display: grid;
            grid-template-columns: 1fr 1fr; /* 雙欄 */
            gap: 8px 0;
            padding-left: 33px;
        }

        .option-btn {
            background: transparent;
            border: none;
            cursor: pointer;
            text-align: left;
            font-family: inherit;
            font-size: inherit;
            color: inherit;
            padding: 2px 5px;
            display: flex;
            align-items: center;
            transition: color 0.1s;
        }

        .option-btn:hover:not(.disabled) {
            text-decoration: underline;
            color: #555;
        }

        .opt-label {
            font-family: "Times New Roman", serif;
            margin-right: 10px;
            font-weight: bold;
        }

        .option-btn.wrong { color: var(--wrong-color); font-weight: bold; text-decoration: line-through; }
        .option-btn.correct { color: var(--correct-color); font-weight: bold; }
        .option-btn.dimmed { opacity: 0.3; pointer-events: none; }

        /* =========================================
           [二、填充題] 專用樣式
           ========================================= */
        .sub-question-grid {
            display: grid;
            grid-template-columns: 1fr; /* 小題單欄排列比較清楚 */
            gap: 15px;
            margin-left: 33px;
            margin-bottom: 10px;
        }
        
        .sub-item {
            border-bottom: 1px dashed #eee;
            padding: 5px 0;
        }

        /* =========================================
           按鈕與解析通用
           ========================================= */
        .reveal-btn {
            background: var(--btn-bg);
            border: 1px solid #ccc;
            padding: 5px 12px;
            font-size: 15px;
            cursor: pointer;
            font-family: inherit;
            border-radius: 4px;
            margin-top: 5px;
        }

        .reveal-btn:hover { background: #e0e0e0; }

        .note-box {
            display: none;
            margin-top: 10px;
            padding: 10px;
            border-top: 1px dashed #aaa;
            color: var(--note-color);
            font-family: var(--font-note); /* 手寫感 */
            font-size: 17px;
            background-color: #fffaf0;
            line-height: 1.5;
        }
        
        .note-label { font-weight: bold; margin-bottom: 5px; display: block; }

        /* RWD */
        @media (max-width: 600px) {
            .paper { padding: 20px; }
            .options-grid { grid-template-columns: 1fr; }
        }
    </style>
</head>
<body>

<div class="paper">
    <header>
        <h1>八年級數學(三) 4-3 練習卷</h1>
        <div class="subtitle">單元：應用問題</div>
    </header>

    <div class="section-header">一、選擇題 (每題 4 分，共 48 分)</div>
    <div id="selection-container"></div>

    <div class="section-header">二、填充題 (每格 3 分，共 24 分)</div>
    <div id="fill-container"></div>

    <div class="section-header">三、非選擇題 (每題 8 分，共 16 分)</div>
    <div id="non-choice-container"></div>
    
    <div class="section-header">四、素養題 (每題 4 分，共 12 分)</div>
    <div id="literacy-container"></div>
</div>

<script>
    // ================= 資料庫 (B4-4-3.pdf 內容) =================

    // 1. 選擇題資料 (12題)
    const selectionData = [
        {
            id: 1,
            q: "已知兩正數的和為 30，平方和為 468，則此兩數應為何？",
            opts: ["8 和 22", "12 和 18", "14 和 16", "16 和 24"],
            ans: 1, // B
            exp: "設兩數為 $x, 30-x$。<br>$x^2 + (30-x)^2 = 468$<br>$2x^2 - 60x + 900 = 468 \\Rightarrow x^2 - 30x + 216 = 0$<br>$(x-12)(x-18)=0 \\Rightarrow x=12$ 或 $18$。<br>故兩數為 12 和 18。"
        },
        {
            id: 2,
            q: "小郁出生於民國 56 年，經過 $x^2$ 年後，正好是民國 $(10x+31)$ 年，則 $x=$？",
            opts: ["5", "6", "8", "9"],
            ans: 0, // A
            exp: "$56 + x^2 = 10x + 31$<br>$x^2 - 10x + 25 = 0$<br>$(x-5)^2 = 0 \\Rightarrow x=5$。"
        },
        {
            id: 3,
            q: "右圖長方形 ABCD 中，設 $\\overline{AB}=x$ 公分，若 $\\overline{BC}$ 比 $\\overline{AB}$ 多 8 公分，且長方形面積為 84 平方公分，則 $\\overline{BC}$ 為多少公分？",
            imgSrc: "B4_4_3_sel_3.png", imgHint: "請截取選擇第3題圖",
            opts: ["9", "14", "12", "16"],
            ans: 1, // B
            exp: "設 $\\overline{AB}=x$，則 $\\overline{BC}=x+8$。<br>$x(x+8)=84 \\Rightarrow x^2+8x-84=0$<br>$(x+14)(x-6)=0 \\Rightarrow x=6$ (負不合)。<br>$\\overline{BC} = 6+8=14$。"
        },
        {
            id: 4,
            q: "如右圖，直角 $\\triangle ABC$ 中，$\\angle B=90^\\circ$，$\\overline{AC}=17$，若兩股和為 23，則 $\\triangle ABC$ 的面積為多少平方單位？",
            imgSrc: "B4_4_3_sel_4.png", imgHint: "請截取選擇第4題圖",
            opts: ["40", "60", "120", "160"],
            ans: 1, // B
            exp: "設兩股為 $a, b$。<br>$a+b=23, a^2+b^2=17^2=289$<br>$(a+b)^2 = a^2+b^2+2ab \\Rightarrow 529 = 289 + 2ab$<br>$2ab = 240 \\Rightarrow ab=120$<br>面積 $= ab/2 = 60$。"
        },
        {
            id: 5,
            q: "霖霖水果行買進一批奇異果，若每個裝 $x$ 顆，恰好可以裝成 $x$ 盒，賣掉 3 盒後，還剩下 40 顆，試問一共買進多少顆奇異果？",
            opts: ["56", "64", "72", "86"],
            ans: 1, // B
            exp: "總數 $x^2$。賣掉 $3x$，剩 $40$。<br>$x^2 - 3x = 40 \\Rightarrow x^2 - 3x - 40 = 0$<br>$(x-8)(x+5)=0 \\Rightarrow x=8$。<br>總數 $= 8^2 = 64$。"
        },
        {
            id: 6,
            q: "湘琦的座號加上 3 所得的數，與座號減掉 11 所得的數，兩數乘積為 24 的平方，試問座號為幾號？",
            opts: ["21", "24", "26", "29"],
            ans: 3, // D
            exp: "設座號 $x$。$(x+3)(x-11)=24^2=576$<br>$x^2-8x-33=576 \\Rightarrow x^2-8x-609=0$<br>$(x-29)(x+21)=0 \\Rightarrow x=29$。"
        },
        {
            id: 7,
            q: "如右圖，等腰 $\\triangle ABC$ 中，$\\overline{AB}=\\overline{AC}$，$\\overline{AD}\\perp\\overline{BC}$ 於 $D$。若 $\\overline{AD}:\\overline{BC}=3:2$ 且 $\\triangle ABC$ 的面積為 72 平方單位，則 $\\overline{AB}=?$？",
            imgSrc: "B4_4_3_sel_7.png", imgHint: "請截取選擇第7題圖",
            opts: ["$4\\sqrt{15}$", "$12\\sqrt{2}$", "$8\\sqrt{3}$", "$6\\sqrt{5}$"],
            ans: 0, // A
            exp: "設 $\\overline{AD}=3k, \\overline{BC}=2k$。<br>面積 $1/2 \\times 2k \\times 3k = 3k^2 = 72 \\Rightarrow k^2=24$。<br>$\\overline{BD}=k$。$\\overline{AB} = \\sqrt{(3k)^2+k^2} = \\sqrt{10k^2} = k\\sqrt{10}$。<br>$\\overline{AB} = \\sqrt{24} \\times \\sqrt{10} = \\sqrt{240} = 4\\sqrt{15}$。"
        },
        {
            id: 8,
            q: "野原牧場有一塊長方形土地，長 40 公尺，寬 30 公尺，今在兩側開闢等寬 $L$ 形步道(如圖)，其餘部分為展示廳。若展示廳面積比步道面積的 2 倍多 124 平方公尺，設路寬 $x$ 公尺，則方程式為何？",
            imgSrc: "B4_4_3_sel_8.png", imgHint: "請截取選擇第8題圖",
            opts: ["$(40-x)(30-x)=2(40x+30x)+124$", "$(40-x)(30-x)+124=2(40x+30x)$", "$(40-x)(30-x)+124=40x+30x-2x^2$", "$(40-x)(30-x)-124=2(40x+30x-x^2)$"],
            ans: 3, // D
            exp: "展示廳面積 $S = (40-x)(30-x)$。<br>步道面積 $P = 總 - S = 1200 - (40-x)(30-x)$。<br>題意：$S = 2P + 124$。<br>整理可得 $(40-x)(30-x) - 124 = 2[1200 - (40-x)(30-x)] = 2P$。<br>且 $P = 40x+30x-x^2$ (十字形面積公式)。<br>故選 (D)。"
        },
        {
            id: 9,
            q: "語家廚房牆壁重新裝潢，若鋪正方形石英磚需 50 塊；若改鋪正方形大理石磚只需 32 塊。設大理石磚比石英磚邊長多 1 公寸，求大理石磚面積？",
            opts: ["16", "25", "36", "49"],
            ans: 1, // B
            exp: "設石英磚邊長 $x$，大理石磚 $x+1$。<br>$50x^2 = 32(x+1)^2 \\Rightarrow 25x^2 = 16(x+1)^2$<br>$5x = 4(x+1) \\Rightarrow x=4$。<br>大理石邊長 5，面積 25。"
        },
        {
            id: 10,
            q: "逸宇計算某正數的平方時，誤將平方看成 2 倍，結果比正確數少 168，求此正數？",
            opts: ["12", "14", "15", "17"],
            ans: 1, // B
            exp: "$x^2 - 2x = 168 \\Rightarrow x^2 - 2x - 168 = 0$<br>$(x-14)(x+12)=0 \\Rightarrow x=14$ (正數)。"
        },
        {
            id: 11,
            q: "如右圖，正方形邊長 10 公分，四角各剪去一個等腰直角三角形變成正八邊形，求正八邊形邊長？",
            imgSrc: "B4_4_3_sel_11.png", imgHint: "請截取選擇第11題圖",
            opts: ["$5\\sqrt{2}+5$", "$5\\sqrt{2}-5$", "$10\\sqrt{2}-5$", "$10\\sqrt{2}-10$"],
            ans: 3, // D
            exp: "設正八邊形邊長 $x$。剪去股長 $y$。<br>$x = \\sqrt{2}y \\Rightarrow y = x/\\sqrt{2}$。<br>正方形邊長 $= y+x+y = x(1+\\sqrt{2}) = 10$。<br>$x = \\frac{10}{\\sqrt{2}+1} = 10(\\sqrt{2}-1) = 10\\sqrt{2}-10$。"
        },
        {
            id: 12,
            q: "布朗尼咖啡店拿鐵一杯 50 元賣 200 杯。每加 1 元少賣 2 杯。某日營收 11250 元，且售價不超過 80，求售價？",
            opts: ["60", "65", "70", "75"],
            ans: 3, // D
            exp: "設加價 $x$ 元。$(50+x)(200-2x) = 11250$<br>化簡得 $x^2 - 50x + 625 = 0 \\Rightarrow (x-25)^2 = 0 \\Rightarrow x=25$。<br>售價 $50+25=75$。"
        }
    ];

    // 2. 填充題資料
    const fillData = [
        { 
            id: 1, 
            q: "如右圖，直角坐標平面上有 $A, B$ 在 $x$ 軸上，且 $\\overline{AP}=\\overline{BP}=5$，若 $P(2,3)$，則：<br>(1) $A$ 點坐標為 <span style='text-decoration:underline;'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>。<br>(2) $B$ 點坐標為 <span style='text-decoration:underline;'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>。<br>(3) $\\triangle ABP$ 面積為 <span style='text-decoration:underline;'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>。", 
            imgSrc: "B4_4_3_fill_1.png", imgHint: "請截取填充第1題圖",
            ans: "(1) (6,0) (2) (-2,0) (3) 12", 
            exp: "設 $A(x,0)$。距離 $\\sqrt{(x-2)^2+3^2}=5 \\Rightarrow (x-2)^2=16 \\Rightarrow x=6, -2$。<br>底 $\\overline{AB}=8$，高 $3$，面積 $12$。" 
        },
        { 
            id: 2, 
            q: "有一梯形的上底、高和下底為三個連續奇數，若此梯形的面積為 81 平方單位，則高為 <span style='text-decoration:underline;'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>。", 
            ans: "9", 
            exp: "設 $2x-1, 2x+1, 2x+3$。<br>面積 $\\frac{(2x-1+2x+3)(2x+1)}{2} = (2x+1)^2 = 81$。<br>高 $2x+1=9$。" 
        },
        { 
            id: 3, 
            q: "右圖為三年八班家長會的邀請卡，長為 57 公分，寬為 22 公分，其內畫上兩條等寬的長條(十字)，剩下的面積為 1100 平方公分，則長條的寬為 <span style='text-decoration:underline;'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span> 公分。", 
            imgSrc: "B4_4_3_fill_3.png", imgHint: "請截取填充第3題圖",
            ans: "2", 
            exp: "$(57-x)(22-x)=1100 \\Rightarrow x^2-79x+154=0$<br>$(x-2)(x-77)=0 \\Rightarrow x=2$。" 
        },
        { 
            id: 4, 
            q: "有一個二位數比其個位數字與十位數字乘積的 5 倍多 2，若個位數字與十位數字的和為 8，則此二位數為 <span style='text-decoration:underline;'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>。", 
            ans: "62", 
            exp: "設十位 $a$，個位 $8-a$。<br>$10a+(8-a) = 5a(8-a)+2$<br>解得 $a=6$。數為 62。" 
        },
        { 
            id: 5, 
            q: "右圖為一矩形桌子緊靠牆壁的俯視圖，若靠牆壁桌面的邊長不算，桌子另三邊長的和為 180 公分，且桌面面積為 4050 平方公分，則桌面的長(靠牆邊)為 <span style='text-decoration:underline;'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span> 公分。", 
            imgSrc: "B4_4_3_fill_5.png", imgHint: "請截取填充第5題圖",
            ans: "90", 
            exp: "設寬 $w$，長 $L$。$L+2w=180, Lw=4050$。<br>$w(180-2w)=4050 \\Rightarrow w=45$。<br>$L=180-90=90$。" 
        }
    ];

    // 3. 非選擇題資料
    const nonChoiceData = [
        { 
            id: 1, 
            q: "美如到市場賣紅豆餅，原本付了 260 元，但老闆說剩下 5 個賣完就要收攤了，如果將剩下 5 個一起帶走，全部只要 300 元。若美如付了 300 元將剩下的紅豆餅一起買走後，發現每個紅豆餅會比原價少 1 元，試問紅豆餅原價每個多少元？",
            imgSrc: "B4_4_3_non_1.png", imgHint: "請截取非選第1題圖",
            ans: "13 元", 
            exp: "設原買 $x$ 個，原價 $260/x$。<br>後來買 $x+5$ 個，單價 $300/(x+5)$。<br>$260/x - 300/(x+5) = 1$<br>解得 $x=20$。原價 $260/20=13$。"
        },
        {
            id: 2, 
            q: "若有七個連續正整數，由小到大排列為 $a, b, c, d, e, f, g$，若 $a^2+b^2+c^2+d^2=e^2+f^2+g^2$，求 $g$？", 
            ans: "27", 
            exp: "設中間數 $d=x$。$(x-3)^2+... = (x+1)^2+...$<br>化簡得 $x^2-24x=0 \\Rightarrow x=24$。<br>$g = x+3 = 27$。" 
        }
    ];

    // 4. 素養題資料
    const literacyData = [
        {
            id: 1,
            q: "明輝開車前往意伶家，原本想以時速 $x$ 公里/小時開車前往，但離約定時間只剩半小時，於是加速以時速 $(x+10)$ 公里/小時行駛，結果比預計時間早 1 小時到達(距離 200km)，試問原本時速為多少公里/小時？",
            imgSrc: "B4_4_3_lit_1.png", imgHint: "請截取素養第1題圖",
            ans: "(A) 40",
            exp: "$200/x - 200/(x+10) = 1$<br>$2000 = x(x+10) \\Rightarrow x^2+10x-2000=0$<br>$(x+50)(x-40)=0 \\Rightarrow x=40$。"
        },
        {
            id: 2,
            q: "園遊會當天，為準備製作畢業紀念冊的素材，同學們要和其餘每位同學兩人合拍一張照片。在沒有漏拍的情況下，總共拍攝了 190 張照片，試問有多少人出席園遊會？",
            ans: "(C) 20",
            exp: "$C(n, 2) = 190 \\Rightarrow n(n-1)/2 = 190$<br>$n(n-1)=380=20\\times 19 \\Rightarrow n=20$。"
        },
        {
            id: 3,
            q: "欣怡幼兒園的幼幼班今年有 70 位學生報到，編列成 $x$ 班，每班人數為 $(10x+3)$ 人，試問此幼幼班每班有多少人？",
            
            ans: "(D) 此題無解",
            exp: "$x(10x+3)=70 \\Rightarrow 10x^2+3x-70=0$。<br>判別式 $9+2800=2809=53^2$。<br>$x=(-3\\pm 53)/20 = 2.5$ 或負值。<br>班級數 $x$ 應為整數，故無整數解。"
        }
    ];

    // ================= 渲染邏輯 =================

    // 1. 渲染選擇題
    function renderSelection() {
        const container = document.getElementById("selection-container");
        const labels = ["(A)", "(B)", "(C)", "(D)"]; 

        selectionData.forEach((q, idx) => {
            const block = document.createElement("div");
            block.className = "question-block";
            
            let html = `
                <div class="q-line">
                    <span class="q-num">${q.id}.</span>
                    <span class="q-content">${q.q}</span>
                </div>
            `;

            if(q.imgSrc) {
                html += `
                    <div class="q-image-box">
                        <img src="${q.imgSrc}" alt="${q.imgHint}" onerror="this.style.display='none'; this.previousElementSibling.style.color='red'; this.previousElementSibling.innerText='⚠️ 圖片未載入，請將圖檔命名為 ${q.imgSrc}';">
                        <p style="margin-top:5px;font-size:12px;color:#999;">(圖檔：${q.imgSrc})</p>
                    </div>
                `;
            }

            html += `<div class="options-grid" id="opt-grid-${idx}">`;
            q.opts.forEach((opt, optIdx) => {
                html += `
                    <button class="option-btn" onclick="checkSelect(this, ${idx}, ${optIdx}, ${q.ans})">
                        <span class="opt-label">${labels[optIdx]}</span>
                        <span>${opt}</span>
                    </button>
                `;
            });
            html += `</div>`;

            html += `
                <div class="note-box" id="sel-note-${idx}">
                    <span class="note-label">解析：</span>
                    ${q.exp}
                </div>
            `;
            block.innerHTML = html;
            container.appendChild(block);
        });
    }

    // 2. 渲染填充題
    function renderFill() {
        const container = document.getElementById("fill-container");
        
        fillData.forEach((q, idx) => {
            const block = document.createElement("div");
            block.className = "question-block";
            
            let html = `
                <div class="q-line">
                    <span class="q-num">${q.id}.</span>
                    <span class="q-content">${q.q}</span>
                </div>
            `;

            if(q.imgSrc) {
                html += `
                    <div class="q-image-box">
                        <img src="${q.imgSrc}" alt="${q.imgHint}" onerror="this.style.display='none'; this.previousElementSibling.style.color='red'; this.previousElementSibling.innerText='⚠️ 圖片未載入，請將圖檔命名為 ${q.imgSrc}';">
                        <p style="margin-top:5px;font-size:12px;color:#999;">(圖檔：${q.imgSrc})</p>
                    </div>
                `;
            }

            html += `
                <button class="reveal-btn" onclick="toggleNote('fill-${idx}')">顯示解析與答案</button>
                <div class="note-box" id="fill-${idx}">
                    <span class="note-label">答：${q.ans}</span>
                    <hr style="border:0; border-top:1px dashed #d32f2f; margin:5px 0;">
                    ${q.exp}
                </div>
            `;
            block.innerHTML = html;
            container.appendChild(block);
        });
    }

    // 3. 渲染通用題型
    function renderSimple(data, containerId, prefix) {
        const container = document.getElementById(containerId);
        data.forEach((q, idx) => {
            const block = document.createElement("div");
            block.className = "question-block";
            
            let html = `
                <div class="q-line">
                    <span class="q-num">${q.id}.</span>
                    <span class="q-content">${q.q}</span>
                </div>
            `;

            if(q.imgSrc) {
                html += `
                    <div class="q-image-box">
                        <img src="${q.imgSrc}" alt="${q.imgHint}" onerror="this.style.display='none'; this.previousElementSibling.style.color='red'; this.previousElementSibling.innerText='⚠️ 圖片未載入，請將圖檔命名為 ${q.imgSrc}';">
                        <p style="margin-top:5px;font-size:12px;color:#999;">(圖檔：${q.imgSrc})</p>
                    </div>
                `;
            }

            html += `
                <button class="reveal-btn" onclick="toggleNote('${prefix}-${idx}')">顯示解析與答案</button>
                <div class="note-box" id="${prefix}-${idx}">
                    <span class="note-label">答：${q.ans}</span>
                    <hr style="border:0; border-top:1px dashed #d32f2f; margin:5px 0;">
                    ${q.exp}
                </div>
            `;
            block.innerHTML = html;
            container.appendChild(block);
        });
    }

    // ================= 互動控制 =================
    window.checkSelect = function(btn, qIdx, userIdx, correctIdx) {
        const parent = document.getElementById(`opt-grid-${qIdx}`);
        const btns = parent.querySelectorAll(".option-btn");
        const note = document.getElementById(`sel-note-${qIdx}`);

        if (btn.classList.contains("disabled") || parent.getAttribute("data-done")) return;
        parent.setAttribute("data-done", "true");

        btns.forEach(b => {
            b.classList.add("disabled");
            if (b !== btn) b.classList.add("dimmed");
        });
        btn.classList.remove("dimmed");

        if (userIdx === correctIdx) {
            btn.classList.add("correct");
        } else {
            btn.classList.add("wrong");
            btns[correctIdx].classList.remove("dimmed");
            btns[correctIdx].classList.add("correct");
        }
        note.style.display = "block";
    };

    window.toggleNote = function(id) {
        const el = document.getElementById(id);
        el.style.display = (el.style.display === "block") ? "none" : "block";
    };

    // ================= 執行渲染 =================
    renderSelection();
    renderFill();
    renderSimple(nonChoiceData, "non-choice-container", "non");
    renderSimple(literacyData, "literacy-container", "lit");

</script>

</body>
</html>
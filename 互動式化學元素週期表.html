<html lang="zh-TW"><head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>完整互動式化學元素週期表</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Microsoft JhengHei', Arial, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 10px;
            margin: 0;
        }
        
        .container {
            max-width: 100%;
            width: 100%;
            margin: 0 auto;
            background: white;
            border-radius: 15px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.1);
            overflow: hidden;
            min-height: calc(100vh - 20px);
            display: flex;
            flex-direction: column;
        }
        
        .header {
            background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);
            color: white;
            padding: 20px;
            text-align: center;
            flex-shrink: 0;
        }
        
        .header h1 {
            font-size: 2rem;
            margin-bottom: 8px;
        }
        
        .header p {
            font-size: 1rem;
            opacity: 0.9;
        }
        
        .controls {
            padding: 15px;
            background: #f8f9fa;
            border-bottom: 1px solid #e9ecef;
            display: flex;
            flex-wrap: wrap;
            gap: 15px;
            align-items: center;
            justify-content: center;
            flex-shrink: 0;
        }
        
        .control-group {
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .control-group label {
            font-weight: 600;
            color: #495057;
        }
        
        select, button {
            padding: 8px 16px;
            border: 2px solid #dee2e6;
            border-radius: 8px;
            font-size: 14px;
            cursor: pointer;
            transition: all 0.3s ease;
        }
        
        select:hover, button:hover {
            border-color: #4facfe;
            transform: translateY(-1px);
        }
        
        .quiz-btn {
            background: linear-gradient(135deg, #ff6b6b, #ee5a24);
            color: white;
            border: none;
            font-weight: 600;
        }
        
        .quiz-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(238, 90, 36, 0.4);
        }
        
        .periodic-table {
            padding: 15px;
            overflow-x: auto;
            flex: 1;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        .table-grid {
            display: grid;
            grid-template-columns: repeat(18, 1fr);
            gap: 1px;
            width: 100%;
            max-width: 1200px;
            margin: 0 auto;
        }
        
        .element {
            aspect-ratio: 1;
            border: 1px solid #ddd;
            border-radius: 4px;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 0.6rem;
            position: relative;
            min-height: 40px;
        }
        
        .element:hover {
            transform: scale(1.15);
            z-index: 10;
            box-shadow: 0 8px 25px rgba(0,0,0,0.3);
        }
        
        .element.selected {
            border-color: #ff6b6b;
            border-width: 3px;
            animation: pulse 1s infinite;
        }
        
        .element.empty {
            background: transparent;
            border: none;
            cursor: default;
        }
        
        .element.empty:hover {
            transform: none;
            box-shadow: none;
        }
        
        @keyframes pulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.05); }
        }
        
        .atomic-number {
            font-size: 0.5rem;
            font-weight: bold;
            color: #666;
        }
        
        .symbol {
            font-size: 0.8rem;
            font-weight: bold;
            margin: 1px 0;
        }
        
        .name {
            font-size: 0.4rem;
            text-align: center;
            line-height: 1;
        }
        
        /* 元素分類顏色 */
        .alkali-metal { background: linear-gradient(135deg, #ff9a9e 0%, #fecfef 100%); }
        .alkaline-earth { background: linear-gradient(135deg, #ffa726 0%, #fb8c00 100%); color: white; }
        .transition-metal { background: linear-gradient(135deg, #ffd89b 0%, #19547b 100%); color: white; }
        .post-transition { background: linear-gradient(135deg, #a8edea 0%, #fed6e3 100%); }
        .metalloid { background: linear-gradient(135deg, #ffecd2 0%, #fcb69f 100%); }
        .reactive-nonmetal { background: linear-gradient(135deg, #a8edea 0%, #fed6e3 100%); }
        .noble-gas { background: linear-gradient(135deg, #e0c3fc 0%, #9bb5ff 100%); }
        .lanthanide { background: linear-gradient(135deg, #ffeaa7 0%, #fab1a0 100%); }
        .actinide { background: linear-gradient(135deg, #fd79a8 0%, #fdcb6e 100%); }
        .unknown { background: linear-gradient(135deg, #ddd 0%, #bbb 100%); }
        
        /* 物質狀態顯示模式 */
        .state-solid { background: linear-gradient(135deg, #8B4513 0%, #D2691E 100%); color: white; }
        .state-liquid { background: linear-gradient(135deg, #4169E1 0%, #87CEEB 100%); color: white; }
        .state-gas { background: linear-gradient(135deg, #FFB6C1 0%, #FFC0CB 100%); }
        
        /* 週期顯示模式 */
        .period-1 { background: linear-gradient(135deg, #FF6B6B 0%, #FF8E8E 100%); }
        .period-2 { background: linear-gradient(135deg, #4ECDC4 0%, #44A08D 100%); }
        .period-3 { background: linear-gradient(135deg, #45B7D1 0%, #96C93D 100%); }
        .period-4 { background: linear-gradient(135deg, #F093FB 0%, #F5576C 100%); }
        .period-5 { background: linear-gradient(135deg, #4FACFE 0%, #00F2FE 100%); }
        .period-6 { background: linear-gradient(135deg, #43E97B 0%, #38F9D7 100%); }
        .period-7 { background: linear-gradient(135deg, #FA709A 0%, #FEE140 100%); }
        
        .info-panel {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: white;
            padding: 30px;
            border-radius: 15px;
            box-shadow: 0 20px 40px rgba(0,0,0,0.3);
            max-width: 500px;
            width: 90%;
            z-index: 1000;
            display: none;
            max-height: 80vh;
            overflow-y: auto;
        }
        
        .info-panel.show {
            display: block;
            animation: fadeIn 0.3s ease;
        }
        
        @keyframes fadeIn {
            from { opacity: 0; transform: translate(-50%, -50%) scale(0.8); }
            to { opacity: 1; transform: translate(-50%, -50%) scale(1); }
        }
        
        .overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.5);
            z-index: 999;
            display: none;
        }
        
        .overlay.show {
            display: block;
        }
        
        .close-btn {
            position: absolute;
            top: 10px;
            right: 15px;
            background: none;
            border: none;
            font-size: 24px;
            cursor: pointer;
            color: #999;
        }
        
        .quiz-panel {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: linear-gradient(135deg, #1e3c72 0%, #2a5298 100%);
            color: white;
            padding: 25px;
            border-radius: 15px;
            box-shadow: 0 20px 40px rgba(0,0,0,0.3);
            max-width: 90%;
            width: 800px;
            max-height: 90vh;
            overflow-y: auto;
            z-index: 1000;
            display: none;
            border: 3px solid #ffd700;
        }
        
        .quiz-panel.show {
            display: block;
            animation: fadeIn 0.3s ease;
        }
        
        .quiz-question {
            font-size: 1.2rem;
            margin-bottom: 20px;
            text-align: center;
            color: white;
        }
        
        .quiz-score {
            text-align: center;
            margin-bottom: 20px;
            font-size: 1.1rem;
            color: #ffd700;
        }
        
        .quiz-feedback {
            text-align: center;
            margin: 20px 0;
            padding: 15px;
            border-radius: 8px;
            font-weight: 600;
        }
        
        .correct {
            background: #d4edda;
            color: #155724;
            border: 1px solid #c3e6cb;
        }
        
        .incorrect {
            background: #f8d7da;
            color: #721c24;
            border: 1px solid #f5c6cb;
        }
        
        .legend {
            display: grid;
            grid-template-columns: repeat(5, 1fr);
            gap: 10px;
            margin: 15px;
            padding: 15px;
            background: #f8f9fa;
            border-radius: 10px;
            flex-shrink: 0;
        }
        
        .legend-item {
            display: flex;
            align-items: center;
            gap: 6px;
            font-size: 0.75rem;
        }
        
        .legend-color {
            width: 16px;
            height: 16px;
            border-radius: 3px;
            border: 1px solid #ddd;
            flex-shrink: 0;
        }
        
        .stats {
            display: grid;
            grid-template-columns: repeat(6, 1fr);
            gap: 10px;
            margin: 15px;
            padding: 15px;
            background: #f8f9fa;
            border-radius: 10px;
            flex-shrink: 0;
        }
        
        .stat-item {
            text-align: center;
            padding: 10px;
            background: white;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        
        .stat-number {
            font-size: 1.5rem;
            font-weight: bold;
            color: #4facfe;
        }
        
        .stat-label {
            font-size: 0.8rem;
            color: #666;
            margin-top: 3px;
        }
        
        @media (max-width: 768px) {
            body {
                padding: 5px;
            }
            
            .container {
                border-radius: 10px;
                min-height: calc(100vh - 10px);
            }
            
            .header h1 {
                font-size: 1.5rem;
            }
            
            .header p {
                font-size: 0.9rem;
            }
            
            .stats {
                grid-template-columns: repeat(3, 1fr);
                margin: 10px;
                padding: 10px;
            }
            
            .stat-number {
                font-size: 1.2rem;
            }
            
            .stat-label {
                font-size: 0.7rem;
            }
            
            .periodic-table {
                padding: 10px;
            }
            
            .table-grid {
                gap: 0.5px;
            }
            
            .element {
                font-size: 0.5rem;
                min-height: 30px;
            }
            
            .symbol {
                font-size: 0.7rem;
            }
            
            .name {
                font-size: 0.35rem;
            }
            
            .legend {
                grid-template-columns: repeat(2, 1fr);
                margin: 10px;
                padding: 10px;
            }
            
            .legend-item {
                font-size: 0.7rem;
            }
            
            .quiz-panel {
                width: 95%;
                padding: 20px;
            }
        }
        
        @media (min-width: 1024px) and (orientation: landscape) {
            .container {
                max-height: 100vh;
            }
            
            .periodic-table {
                flex: 1;
                min-height: 0;
            }
            
            .table-grid {
                height: 100%;
                max-height: 500px;
            }
        }
        
        .developer-btn {
            position: fixed;
            bottom: 20px;
            right: 20px;
            width: 50px;
            height: 50px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            border-radius: 50%;
            cursor: pointer;
            font-size: 18px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.3);
            transition: all 0.3s ease;
            z-index: 1001;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        .developer-btn:hover {
            transform: scale(1.1);
            box-shadow: 0 6px 20px rgba(0,0,0,0.4);
        }
        
        .code-modal {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: #1e1e1e;
            color: #d4d4d4;
            padding: 20px;
            border-radius: 10px;
            box-shadow: 0 20px 40px rgba(0,0,0,0.5);
            width: 90%;
            max-width: 800px;
            max-height: 80vh;
            z-index: 1002;
            display: none;
            flex-direction: column;
        }
        
        .code-modal.show {
            display: flex;
        }
        
        .code-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
            padding-bottom: 10px;
            border-bottom: 1px solid #333;
        }
        
        .code-title {
            color: #4facfe;
            font-size: 1.2rem;
            font-weight: bold;
        }
        
        .copy-btn {
            background: #28a745;
            color: white;
            border: none;
            padding: 8px 16px;
            border-radius: 5px;
            cursor: pointer;
            font-size: 14px;
            transition: all 0.3s ease;
        }
        
        .copy-btn:hover {
            background: #218838;
            transform: translateY(-1px);
        }
        
        .copy-btn.copied {
            background: #17a2b8;
        }
        
        .code-content {
            flex: 1;
            overflow-y: auto;
            background: #2d2d2d;
            border: 1px solid #333;
            border-radius: 5px;
            padding: 15px;
            font-family: 'Courier New', monospace;
            font-size: 12px;
            line-height: 1.4;
            white-space: pre-wrap;
            word-wrap: break-word;
        }
    </style>
<style id="_goober"> .go1475592160{height:0;}.go1671063245{height:auto;}.go1888806478{display:flex;flex-wrap:wrap;flex-grow:1;}@media (min-width:600px){.go1888806478{flex-grow:initial;min-width:288px;}}.go167266335{background-color:#313131;font-size:0.875rem;line-height:1.43;letter-spacing:0.01071em;color:#fff;align-items:center;padding:6px 16px;border-radius:4px;box-shadow:0px 3px 5px -1px rgba(0,0,0,0.2),0px 6px 10px 0px rgba(0,0,0,0.14),0px 1px 18px 0px rgba(0,0,0,0.12);}.go3162094071{padding-left:20px;}.go3844575157{background-color:#313131;}.go1725278324{background-color:#43a047;}.go3651055292{background-color:#d32f2f;}.go4215275574{background-color:#ff9800;}.go1930647212{background-color:#2196f3;}.go946087465{display:flex;align-items:center;padding:8px 0;}.go703367398{display:flex;align-items:center;margin-left:auto;padding-left:16px;margin-right:-8px;}.go3963613292{width:100%;position:relative;transform:translateX(0);top:0;right:0;bottom:0;left:0;min-width:288px;}.go1141946668{box-sizing:border-box;display:flex;max-height:100%;position:fixed;z-index:1400;height:auto;width:auto;transition:top 300ms ease 0ms,right 300ms ease 0ms,bottom 300ms ease 0ms,left 300ms ease 0ms,max-width 300ms ease 0ms;pointer-events:none;max-width:calc(100% - 40px);}.go1141946668 .notistack-CollapseWrapper{padding:6px 0px;transition:padding 300ms ease 0ms;}@media (max-width:599.95px){.go1141946668{width:100%;max-width:calc(100% - 32px);}}.go3868796639 .notistack-CollapseWrapper{padding:2px 0px;}.go3118922589{top:14px;flex-direction:column;}.go1453831412{bottom:14px;flex-direction:column-reverse;}.go4027089540{left:20px;}@media (min-width:600px){.go4027089540{align-items:flex-start;}}@media (max-width:599.95px){.go4027089540{left:16px;}}.go2989568495{right:20px;}@media (min-width:600px){.go2989568495{align-items:flex-end;}}@media (max-width:599.95px){.go2989568495{right:16px;}}.go4034260886{left:50%;transform:translateX(-50%);}@media (min-width:600px){.go4034260886{align-items:center;}}</style></head>
<body>
    <div class="container">
        <div class="header">
            <h1>🧪 完整互動式化學元素週期表</h1>
            <p>探索全部118個化學元素的奧秘與分類</p>
        </div>
        
        <div class="stats" id="stats">
                <div class="stat-item">
                    <div class="stat-number">118</div>
                    <div class="stat-label">總元素數</div>
                </div>
                <div class="stat-item">
                    <div class="stat-number">104</div>
                    <div class="stat-label">固體元素</div>
                </div>
                <div class="stat-item">
                    <div class="stat-number">2</div>
                    <div class="stat-label">液體元素</div>
                </div>
                <div class="stat-item">
                    <div class="stat-number">12</div>
                    <div class="stat-label">氣體元素</div>
                </div>
                <div class="stat-item">
                    <div class="stat-number">35</div>
                    <div class="stat-label">過渡金屬</div>
                </div>
                <div class="stat-item">
                    <div class="stat-number">11</div>
                    <div class="stat-label">活性非金屬</div>
                </div>
            </div>
        
        <div class="controls">
            <div class="control-group">
                <label for="displayMode">顯示模式：</label>
                <select id="displayMode">
                    <option value="classification">元素分類</option>
                    <option value="state">物質狀態</option>
                    <option value="period">族與週期</option>
                </select>
            </div>
            
            <button class="quiz-btn" onclick="startQuiz()">🔓 密室逃脫</button>
            <button onclick="showAllElements()">📋 查看所有元素</button>
        </div>
        
        <div class="periodic-table">
            <div class="table-grid" id="periodicTable"><div class="element reactive-nonmetal">
                    <div class="atomic-number">1</div>
                    <div class="symbol">H</div>
                    <div class="name">氫</div>
                </div><div class="element empty"></div><div class="element empty"></div><div class="element empty"></div><div class="element empty"></div><div class="element empty"></div><div class="element empty"></div><div class="element empty"></div><div class="element empty"></div><div class="element empty"></div><div class="element empty"></div><div class="element empty"></div><div class="element empty"></div><div class="element empty"></div><div class="element empty"></div><div class="element empty"></div><div class="element empty"></div><div class="element noble-gas">
                    <div class="atomic-number">2</div>
                    <div class="symbol">He</div>
                    <div class="name">氦</div>
                </div><div class="element alkali-metal">
                    <div class="atomic-number">3</div>
                    <div class="symbol">Li</div>
                    <div class="name">鋰</div>
                </div><div class="element alkaline-earth">
                    <div class="atomic-number">4</div>
                    <div class="symbol">Be</div>
                    <div class="name">鈹</div>
                </div><div class="element empty"></div><div class="element empty"></div><div class="element empty"></div><div class="element empty"></div><div class="element empty"></div><div class="element empty"></div><div class="element empty"></div><div class="element empty"></div><div class="element empty"></div><div class="element empty"></div><div class="element metalloid">
                    <div class="atomic-number">5</div>
                    <div class="symbol">B</div>
                    <div class="name">硼</div>
                </div><div class="element reactive-nonmetal">
                    <div class="atomic-number">6</div>
                    <div class="symbol">C</div>
                    <div class="name">碳</div>
                </div><div class="element reactive-nonmetal">
                    <div class="atomic-number">7</div>
                    <div class="symbol">N</div>
                    <div class="name">氮</div>
                </div><div class="element reactive-nonmetal">
                    <div class="atomic-number">8</div>
                    <div class="symbol">O</div>
                    <div class="name">氧</div>
                </div><div class="element reactive-nonmetal">
                    <div class="atomic-number">9</div>
                    <div class="symbol">F</div>
                    <div class="name">氟</div>
                </div><div class="element noble-gas">
                    <div class="atomic-number">10</div>
                    <div class="symbol">Ne</div>
                    <div class="name">氖</div>
                </div><div class="element alkali-metal">
                    <div class="atomic-number">11</div>
                    <div class="symbol">Na</div>
                    <div class="name">鈉</div>
                </div><div class="element alkaline-earth">
                    <div class="atomic-number">12</div>
                    <div class="symbol">Mg</div>
                    <div class="name">鎂</div>
                </div><div class="element empty"></div><div class="element empty"></div><div class="element empty"></div><div class="element empty"></div><div class="element empty"></div><div class="element empty"></div><div class="element empty"></div><div class="element empty"></div><div class="element empty"></div><div class="element empty"></div><div class="element post-transition">
                    <div class="atomic-number">13</div>
                    <div class="symbol">Al</div>
                    <div class="name">鋁</div>
                </div><div class="element metalloid">
                    <div class="atomic-number">14</div>
                    <div class="symbol">Si</div>
                    <div class="name">矽</div>
                </div><div class="element reactive-nonmetal">
                    <div class="atomic-number">15</div>
                    <div class="symbol">P</div>
                    <div class="name">磷</div>
                </div><div class="element reactive-nonmetal">
                    <div class="atomic-number">16</div>
                    <div class="symbol">S</div>
                    <div class="name">硫</div>
                </div><div class="element reactive-nonmetal">
                    <div class="atomic-number">17</div>
                    <div class="symbol">Cl</div>
                    <div class="name">氯</div>
                </div><div class="element noble-gas">
                    <div class="atomic-number">18</div>
                    <div class="symbol">Ar</div>
                    <div class="name">氬</div>
                </div><div class="element alkali-metal">
                    <div class="atomic-number">19</div>
                    <div class="symbol">K</div>
                    <div class="name">鉀</div>
                </div><div class="element alkaline-earth">
                    <div class="atomic-number">20</div>
                    <div class="symbol">Ca</div>
                    <div class="name">鈣</div>
                </div><div class="element transition-metal">
                    <div class="atomic-number">21</div>
                    <div class="symbol">Sc</div>
                    <div class="name">鈧</div>
                </div><div class="element transition-metal">
                    <div class="atomic-number">22</div>
                    <div class="symbol">Ti</div>
                    <div class="name">鈦</div>
                </div><div class="element transition-metal">
                    <div class="atomic-number">23</div>
                    <div class="symbol">V</div>
                    <div class="name">釩</div>
                </div><div class="element transition-metal">
                    <div class="atomic-number">24</div>
                    <div class="symbol">Cr</div>
                    <div class="name">鉻</div>
                </div><div class="element transition-metal">
                    <div class="atomic-number">25</div>
                    <div class="symbol">Mn</div>
                    <div class="name">錳</div>
                </div><div class="element transition-metal">
                    <div class="atomic-number">26</div>
                    <div class="symbol">Fe</div>
                    <div class="name">鐵</div>
                </div><div class="element transition-metal">
                    <div class="atomic-number">27</div>
                    <div class="symbol">Co</div>
                    <div class="name">鈷</div>
                </div><div class="element transition-metal">
                    <div class="atomic-number">28</div>
                    <div class="symbol">Ni</div>
                    <div class="name">鎳</div>
                </div><div class="element transition-metal">
                    <div class="atomic-number">29</div>
                    <div class="symbol">Cu</div>
                    <div class="name">銅</div>
                </div><div class="element transition-metal">
                    <div class="atomic-number">30</div>
                    <div class="symbol">Zn</div>
                    <div class="name">鋅</div>
                </div><div class="element post-transition">
                    <div class="atomic-number">31</div>
                    <div class="symbol">Ga</div>
                    <div class="name">鎵</div>
                </div><div class="element metalloid">
                    <div class="atomic-number">32</div>
                    <div class="symbol">Ge</div>
                    <div class="name">鍺</div>
                </div><div class="element metalloid">
                    <div class="atomic-number">33</div>
                    <div class="symbol">As</div>
                    <div class="name">砷</div>
                </div><div class="element reactive-nonmetal">
                    <div class="atomic-number">34</div>
                    <div class="symbol">Se</div>
                    <div class="name">硒</div>
                </div><div class="element reactive-nonmetal">
                    <div class="atomic-number">35</div>
                    <div class="symbol">Br</div>
                    <div class="name">溴</div>
                </div><div class="element noble-gas">
                    <div class="atomic-number">36</div>
                    <div class="symbol">Kr</div>
                    <div class="name">氪</div>
                </div><div class="element alkali-metal">
                    <div class="atomic-number">37</div>
                    <div class="symbol">Rb</div>
                    <div class="name">銣</div>
                </div><div class="element alkaline-earth">
                    <div class="atomic-number">38</div>
                    <div class="symbol">Sr</div>
                    <div class="name">鍶</div>
                </div><div class="element transition-metal">
                    <div class="atomic-number">39</div>
                    <div class="symbol">Y</div>
                    <div class="name">釔</div>
                </div><div class="element transition-metal">
                    <div class="atomic-number">40</div>
                    <div class="symbol">Zr</div>
                    <div class="name">鋯</div>
                </div><div class="element transition-metal">
                    <div class="atomic-number">41</div>
                    <div class="symbol">Nb</div>
                    <div class="name">鈮</div>
                </div><div class="element transition-metal">
                    <div class="atomic-number">42</div>
                    <div class="symbol">Mo</div>
                    <div class="name">鉬</div>
                </div><div class="element transition-metal">
                    <div class="atomic-number">43</div>
                    <div class="symbol">Tc</div>
                    <div class="name">鎝</div>
                </div><div class="element transition-metal">
                    <div class="atomic-number">44</div>
                    <div class="symbol">Ru</div>
                    <div class="name">釕</div>
                </div><div class="element transition-metal">
                    <div class="atomic-number">45</div>
                    <div class="symbol">Rh</div>
                    <div class="name">銠</div>
                </div><div class="element transition-metal">
                    <div class="atomic-number">46</div>
                    <div class="symbol">Pd</div>
                    <div class="name">鈀</div>
                </div><div class="element transition-metal">
                    <div class="atomic-number">47</div>
                    <div class="symbol">Ag</div>
                    <div class="name">銀</div>
                </div><div class="element transition-metal">
                    <div class="atomic-number">48</div>
                    <div class="symbol">Cd</div>
                    <div class="name">鎘</div>
                </div><div class="element post-transition">
                    <div class="atomic-number">49</div>
                    <div class="symbol">In</div>
                    <div class="name">銦</div>
                </div><div class="element post-transition">
                    <div class="atomic-number">50</div>
                    <div class="symbol">Sn</div>
                    <div class="name">錫</div>
                </div><div class="element metalloid">
                    <div class="atomic-number">51</div>
                    <div class="symbol">Sb</div>
                    <div class="name">銻</div>
                </div><div class="element metalloid">
                    <div class="atomic-number">52</div>
                    <div class="symbol">Te</div>
                    <div class="name">碲</div>
                </div><div class="element reactive-nonmetal">
                    <div class="atomic-number">53</div>
                    <div class="symbol">I</div>
                    <div class="name">碘</div>
                </div><div class="element noble-gas">
                    <div class="atomic-number">54</div>
                    <div class="symbol">Xe</div>
                    <div class="name">氙</div>
                </div><div class="element alkali-metal">
                    <div class="atomic-number">55</div>
                    <div class="symbol">Cs</div>
                    <div class="name">銫</div>
                </div><div class="element alkaline-earth">
                    <div class="atomic-number">56</div>
                    <div class="symbol">Ba</div>
                    <div class="name">鋇</div>
                </div><div class="element empty"></div><div class="element transition-metal">
                    <div class="atomic-number">72</div>
                    <div class="symbol">Hf</div>
                    <div class="name">鉿</div>
                </div><div class="element transition-metal">
                    <div class="atomic-number">73</div>
                    <div class="symbol">Ta</div>
                    <div class="name">鉭</div>
                </div><div class="element transition-metal">
                    <div class="atomic-number">74</div>
                    <div class="symbol">W</div>
                    <div class="name">鎢</div>
                </div><div class="element transition-metal">
                    <div class="atomic-number">75</div>
                    <div class="symbol">Re</div>
                    <div class="name">錸</div>
                </div><div class="element transition-metal">
                    <div class="atomic-number">76</div>
                    <div class="symbol">Os</div>
                    <div class="name">鋨</div>
                </div><div class="element transition-metal">
                    <div class="atomic-number">77</div>
                    <div class="symbol">Ir</div>
                    <div class="name">銥</div>
                </div><div class="element transition-metal">
                    <div class="atomic-number">78</div>
                    <div class="symbol">Pt</div>
                    <div class="name">鉑</div>
                </div><div class="element transition-metal">
                    <div class="atomic-number">79</div>
                    <div class="symbol">Au</div>
                    <div class="name">金</div>
                </div><div class="element transition-metal">
                    <div class="atomic-number">80</div>
                    <div class="symbol">Hg</div>
                    <div class="name">汞</div>
                </div><div class="element post-transition">
                    <div class="atomic-number">81</div>
                    <div class="symbol">Tl</div>
                    <div class="name">鉈</div>
                </div><div class="element post-transition">
                    <div class="atomic-number">82</div>
                    <div class="symbol">Pb</div>
                    <div class="name">鉛</div>
                </div><div class="element post-transition">
                    <div class="atomic-number">83</div>
                    <div class="symbol">Bi</div>
                    <div class="name">鉍</div>
                </div><div class="element post-transition">
                    <div class="atomic-number">84</div>
                    <div class="symbol">Po</div>
                    <div class="name">釙</div>
                </div><div class="element metalloid">
                    <div class="atomic-number">85</div>
                    <div class="symbol">At</div>
                    <div class="name">砈</div>
                </div><div class="element noble-gas">
                    <div class="atomic-number">86</div>
                    <div class="symbol">Rn</div>
                    <div class="name">氡</div>
                </div><div class="element alkali-metal">
                    <div class="atomic-number">87</div>
                    <div class="symbol">Fr</div>
                    <div class="name">鍅</div>
                </div><div class="element alkaline-earth">
                    <div class="atomic-number">88</div>
                    <div class="symbol">Ra</div>
                    <div class="name">鐳</div>
                </div><div class="element empty"></div><div class="element transition-metal">
                    <div class="atomic-number">104</div>
                    <div class="symbol">Rf</div>
                    <div class="name">鑪</div>
                </div><div class="element transition-metal">
                    <div class="atomic-number">105</div>
                    <div class="symbol">Db</div>
                    <div class="name">𨧀</div>
                </div><div class="element transition-metal">
                    <div class="atomic-number">106</div>
                    <div class="symbol">Sg</div>
                    <div class="name">𨭎</div>
                </div><div class="element transition-metal">
                    <div class="atomic-number">107</div>
                    <div class="symbol">Bh</div>
                    <div class="name">𨨏</div>
                </div><div class="element transition-metal">
                    <div class="atomic-number">108</div>
                    <div class="symbol">Hs</div>
                    <div class="name">𨭆</div>
                </div><div class="element unknown">
                    <div class="atomic-number">109</div>
                    <div class="symbol">Mt</div>
                    <div class="name">鿏</div>
                </div><div class="element unknown">
                    <div class="atomic-number">110</div>
                    <div class="symbol">Ds</div>
                    <div class="name">𨭎</div>
                </div><div class="element unknown">
                    <div class="atomic-number">111</div>
                    <div class="symbol">Rg</div>
                    <div class="name">錀</div>
                </div><div class="element transition-metal">
                    <div class="atomic-number">112</div>
                    <div class="symbol">Cn</div>
                    <div class="name">鎶</div>
                </div><div class="element unknown">
                    <div class="atomic-number">113</div>
                    <div class="symbol">Nh</div>
                    <div class="name">鉨</div>
                </div><div class="element unknown">
                    <div class="atomic-number">114</div>
                    <div class="symbol">Fl</div>
                    <div class="name">鈇</div>
                </div><div class="element unknown">
                    <div class="atomic-number">115</div>
                    <div class="symbol">Mc</div>
                    <div class="name">鏌</div>
                </div><div class="element unknown">
                    <div class="atomic-number">116</div>
                    <div class="symbol">Lv</div>
                    <div class="name">鉝</div>
                </div><div class="element unknown">
                    <div class="atomic-number">117</div>
                    <div class="symbol">Ts</div>
                    <div class="name">鿬</div>
                </div><div class="element unknown">
                    <div class="atomic-number">118</div>
                    <div class="symbol">Og</div>
                    <div class="name">鿫</div>
                </div><div class="element empty"></div><div class="element empty"></div><div class="element empty"></div><div class="element empty"></div><div class="element empty"></div><div class="element empty"></div><div class="element empty"></div><div class="element empty"></div><div class="element empty"></div><div class="element empty"></div><div class="element empty"></div><div class="element empty"></div><div class="element empty"></div><div class="element empty"></div><div class="element empty"></div><div class="element empty"></div><div class="element empty"></div><div class="element empty"></div><div class="element empty"></div><div class="element empty"></div><div class="element empty"></div><div class="element lanthanide">
                    <div class="atomic-number">57</div>
                    <div class="symbol">La</div>
                    <div class="name">鑭</div>
                </div><div class="element lanthanide">
                    <div class="atomic-number">58</div>
                    <div class="symbol">Ce</div>
                    <div class="name">鈰</div>
                </div><div class="element lanthanide">
                    <div class="atomic-number">59</div>
                    <div class="symbol">Pr</div>
                    <div class="name">鐠</div>
                </div><div class="element lanthanide">
                    <div class="atomic-number">60</div>
                    <div class="symbol">Nd</div>
                    <div class="name">釹</div>
                </div><div class="element lanthanide">
                    <div class="atomic-number">61</div>
                    <div class="symbol">Pm</div>
                    <div class="name">鉕</div>
                </div><div class="element lanthanide">
                    <div class="atomic-number">62</div>
                    <div class="symbol">Sm</div>
                    <div class="name">釤</div>
                </div><div class="element lanthanide">
                    <div class="atomic-number">63</div>
                    <div class="symbol">Eu</div>
                    <div class="name">銪</div>
                </div><div class="element lanthanide">
                    <div class="atomic-number">64</div>
                    <div class="symbol">Gd</div>
                    <div class="name">釓</div>
                </div><div class="element lanthanide">
                    <div class="atomic-number">65</div>
                    <div class="symbol">Tb</div>
                    <div class="name">鋱</div>
                </div><div class="element lanthanide">
                    <div class="atomic-number">66</div>
                    <div class="symbol">Dy</div>
                    <div class="name">鏑</div>
                </div><div class="element lanthanide">
                    <div class="atomic-number">67</div>
                    <div class="symbol">Ho</div>
                    <div class="name">鈥</div>
                </div><div class="element lanthanide">
                    <div class="atomic-number">68</div>
                    <div class="symbol">Er</div>
                    <div class="name">鉺</div>
                </div><div class="element lanthanide">
                    <div class="atomic-number">69</div>
                    <div class="symbol">Tm</div>
                    <div class="name">銩</div>
                </div><div class="element lanthanide">
                    <div class="atomic-number">70</div>
                    <div class="symbol">Yb</div>
                    <div class="name">鐿</div>
                </div><div class="element lanthanide">
                    <div class="atomic-number">71</div>
                    <div class="symbol">Lu</div>
                    <div class="name">鎦</div>
                </div><div class="element empty"></div><div class="element empty"></div><div class="element empty"></div><div class="element actinide">
                    <div class="atomic-number">89</div>
                    <div class="symbol">Ac</div>
                    <div class="name">錒</div>
                </div><div class="element actinide">
                    <div class="atomic-number">90</div>
                    <div class="symbol">Th</div>
                    <div class="name">釷</div>
                </div><div class="element actinide">
                    <div class="atomic-number">91</div>
                    <div class="symbol">Pa</div>
                    <div class="name">鏷</div>
                </div><div class="element actinide">
                    <div class="atomic-number">92</div>
                    <div class="symbol">U</div>
                    <div class="name">鈾</div>
                </div><div class="element actinide">
                    <div class="atomic-number">93</div>
                    <div class="symbol">Np</div>
                    <div class="name">錼</div>
                </div><div class="element actinide">
                    <div class="atomic-number">94</div>
                    <div class="symbol">Pu</div>
                    <div class="name">鈽</div>
                </div><div class="element actinide">
                    <div class="atomic-number">95</div>
                    <div class="symbol">Am</div>
                    <div class="name">鋂</div>
                </div><div class="element actinide">
                    <div class="atomic-number">96</div>
                    <div class="symbol">Cm</div>
                    <div class="name">鋦</div>
                </div><div class="element actinide">
                    <div class="atomic-number">97</div>
                    <div class="symbol">Bk</div>
                    <div class="name">錇</div>
                </div><div class="element actinide">
                    <div class="atomic-number">98</div>
                    <div class="symbol">Cf</div>
                    <div class="name">鐦</div>
                </div><div class="element actinide">
                    <div class="atomic-number">99</div>
                    <div class="symbol">Es</div>
                    <div class="name">鑀</div>
                </div><div class="element actinide">
                    <div class="atomic-number">100</div>
                    <div class="symbol">Fm</div>
                    <div class="name">鐨</div>
                </div><div class="element actinide">
                    <div class="atomic-number">101</div>
                    <div class="symbol">Md</div>
                    <div class="name">鍆</div>
                </div><div class="element actinide">
                    <div class="atomic-number">102</div>
                    <div class="symbol">No</div>
                    <div class="name">鍩</div>
                </div><div class="element actinide">
                    <div class="atomic-number">103</div>
                    <div class="symbol">Lr</div>
                    <div class="name">鐒</div>
                </div></div>
        </div>
        
        <div class="legend" id="legend">
                    <div class="legend-item"><div class="legend-color alkali-metal"></div><span>鹼金屬 (6個)</span></div>
                    <div class="legend-item"><div class="legend-color alkaline-earth"></div><span>鹼土金屬 (6個)</span></div>
                    <div class="legend-item"><div class="legend-color transition-metal"></div><span>過渡金屬 (38個)</span></div>
                    <div class="legend-item"><div class="legend-color post-transition"></div><span>後過渡金屬 (7個)</span></div>
                    <div class="legend-item"><div class="legend-color metalloid"></div><span>類金屬 (7個)</span></div>
                    <div class="legend-item"><div class="legend-color reactive-nonmetal"></div><span>活性非金屬 (16個)</span></div>
                    <div class="legend-item"><div class="legend-color noble-gas"></div><span>惰性氣體 (7個)</span></div>
                    <div class="legend-item"><div class="legend-color lanthanide"></div><span>鑭系元素 (15個)</span></div>
                    <div class="legend-item"><div class="legend-color actinide"></div><span>錒系元素 (15個)</span></div>
                    <div class="legend-item"><div class="legend-color unknown"></div><span>未知性質 (1個)</span></div>
                </div>
    </div>
    
    <div class="overlay" id="overlay" onclick="closePanel()"></div>
    
    <div class="info-panel" id="infoPanel">
        <button class="close-btn" onclick="closePanel()">×</button>
        <div id="elementInfo">
            <!-- 元素詳細資訊將在這裡顯示 -->
        </div>
    </div>
    
    <div class="quiz-panel" id="quizPanel">
        <button class="close-btn" onclick="closeQuiz()">×</button>
        <div class="quiz-score" id="quizScore" style="color: #ffd700; font-weight: bold;">關卡：1 / 12</div>
        <div id="levelTitle" style="text-align: center; font-size: 1.5rem; margin-bottom: 15px; color: #ffd700;"></div>
        <div id="storyText" style="background: rgba(255,255,255,0.1); padding: 15px; border-radius: 10px; margin-bottom: 20px; line-height: 1.6;"></div>
        <div class="quiz-question" id="quizQuestion" style="font-size: 1.1rem; font-weight: bold; text-align: center; margin-bottom: 20px;"></div>
        <div id="answerButtons" style="display: grid; grid-template-columns: 1fr 1fr; gap: 10px; margin-bottom: 20px;"></div>
        <div class="quiz-feedback" id="quizFeedback" style="display: none;"></div>
        <div style="text-align: center; margin-top: 20px;">
            <button onclick="nextLevel()" id="nextBtn" style="display: none; background: #28a745; color: white; border: none; padding: 10px 20px; border-radius: 5px; cursor: pointer;">下一關</button>
            <button onclick="closeQuiz()" id="finishBtn" style="display: none; background: #ffd700; color: #1e3c72; border: none; padding: 10px 20px; border-radius: 5px; cursor: pointer; font-weight: bold;">完成逃脫！</button>
        </div>
    </div>
    
    <!-- 開發者按鈕 -->
    <button class="developer-btn" onclick="showCodeModal()" title="查看程式碼">
        &lt;/&gt;
    </button>
    
    <!-- 程式碼視窗 -->
    <div class="code-modal" id="codeModal">
        <div class="code-header">
            <div class="code-title">📋 完整程式碼</div>
            <div>
                <button class="copy-btn" id="copyBtn" onclick="copyCode()">複製程式碼</button>
                <button class="close-btn" onclick="closeCodeModal()" style="position: relative; top: 0; right: 0; margin-left: 10px;">×</button>
            </div>
        </div>
        <div class="code-content" id="codeContent">
            <!-- 程式碼內容將在這裡顯示 -->
        </div>
    </div>

    <script>
        // 完整的118個元素資料
        const elements = [
            // 第1週期
            {symbol: 'H', name: '氫', english: 'Hydrogen', number: 1, period: 1, group: 1, classification: 'reactive-nonmetal', state: 'gas', uses: '燃料電池、氣球充氣、化學反應', row: 0, col: 0},
            {symbol: 'He', name: '氦', english: 'Helium', number: 2, period: 1, group: 18, classification: 'noble-gas', state: 'gas', uses: '氣球、潛水呼吸氣體、低溫冷卻', row: 0, col: 17},
            
            // 第2週期
            {symbol: 'Li', name: '鋰', english: 'Lithium', number: 3, period: 2, group: 1, classification: 'alkali-metal', state: 'solid', uses: '鋰電池、精神科藥物、合金', row: 1, col: 0},
            {symbol: 'Be', name: '鈹', english: 'Beryllium', number: 4, period: 2, group: 2, classification: 'alkaline-earth', state: 'solid', uses: '合金材料、X光窗口、核反應器', row: 1, col: 1},
            {symbol: 'B', name: '硼', english: 'Boron', number: 5, period: 2, group: 13, classification: 'metalloid', state: 'solid', uses: '玻璃纖維、清潔劑、半導體', row: 1, col: 12},
            {symbol: 'C', name: '碳', english: 'Carbon', number: 6, period: 2, group: 14, classification: 'reactive-nonmetal', state: 'solid', uses: '鑽石、石墨、有機化合物、鋼鐵', row: 1, col: 13},
            {symbol: 'N', name: '氮', english: 'Nitrogen', number: 7, period: 2, group: 15, classification: 'reactive-nonmetal', state: 'gas', uses: '肥料、液氮冷凍、炸藥', row: 1, col: 14},
            {symbol: 'O', name: '氧', english: 'Oxygen', number: 8, period: 2, group: 16, classification: 'reactive-nonmetal', state: 'gas', uses: '呼吸、燃燒助燃、醫療用氧', row: 1, col: 15},
            {symbol: 'F', name: '氟', english: 'Fluorine', number: 9, period: 2, group: 17, classification: 'reactive-nonmetal', state: 'gas', uses: '牙膏、不沾鍋塗層、製冷劑', row: 1, col: 16},
            {symbol: 'Ne', name: '氖', english: 'Neon', number: 10, period: 2, group: 18, classification: 'noble-gas', state: 'gas', uses: '霓虹燈、雷射、低溫研究', row: 1, col: 17},
            
            // 第3週期
            {symbol: 'Na', name: '鈉', english: 'Sodium', number: 11, period: 3, group: 1, classification: 'alkali-metal', state: 'solid', uses: '食鹽、肥皂、路燈', row: 2, col: 0},
            {symbol: 'Mg', name: '鎂', english: 'Magnesium', number: 12, period: 3, group: 2, classification: 'alkaline-earth', state: 'solid', uses: '合金、煙火、鎂帶燃燒', row: 2, col: 1},
            {symbol: 'Al', name: '鋁', english: 'Aluminum', number: 13, period: 3, group: 13, classification: 'post-transition', state: 'solid', uses: '鋁罐、飛機材料、建築', row: 2, col: 12},
            {symbol: 'Si', name: '矽', english: 'Silicon', number: 14, period: 3, group: 14, classification: 'metalloid', state: 'solid', uses: '電腦晶片、玻璃、太陽能板', row: 2, col: 13},
            {symbol: 'P', name: '磷', english: 'Phosphorus', number: 15, period: 3, group: 15, classification: 'reactive-nonmetal', state: 'solid', uses: '火柴、肥料、DNA結構', row: 2, col: 14},
            {symbol: 'S', name: '硫', english: 'Sulfur', number: 16, period: 3, group: 16, classification: 'reactive-nonmetal', state: 'solid', uses: '硫酸、橡膠硫化、火藥', row: 2, col: 15},
            {symbol: 'Cl', name: '氯', english: 'Chlorine', number: 17, period: 3, group: 17, classification: 'reactive-nonmetal', state: 'gas', uses: '漂白水、游泳池消毒、PVC塑膠', row: 2, col: 16},
            {symbol: 'Ar', name: '氬', english: 'Argon', number: 18, period: 3, group: 18, classification: 'noble-gas', state: 'gas', uses: '燈泡充氣、焊接保護氣、雷射', row: 2, col: 17},
            
            // 第4週期
            {symbol: 'K', name: '鉀', english: 'Potassium', number: 19, period: 4, group: 1, classification: 'alkali-metal', state: 'solid', uses: '肥料、香蕉營養素、神經傳導', row: 3, col: 0},
            {symbol: 'Ca', name: '鈣', english: 'Calcium', number: 20, period: 4, group: 2, classification: 'alkaline-earth', state: 'solid', uses: '骨骼牙齒、石灰、水泥', row: 3, col: 1},
            {symbol: 'Sc', name: '鈧', english: 'Scandium', number: 21, period: 4, group: 3, classification: 'transition-metal', state: 'solid', uses: '合金、高強度材料', row: 3, col: 2},
            {symbol: 'Ti', name: '鈦', english: 'Titanium', number: 22, period: 4, group: 4, classification: 'transition-metal', state: 'solid', uses: '飛機、人工關節、白色顏料', row: 3, col: 3},
            {symbol: 'V', name: '釩', english: 'Vanadium', number: 23, period: 4, group: 5, classification: 'transition-metal', state: 'solid', uses: '鋼鐵合金、催化劑', row: 3, col: 4},
            {symbol: 'Cr', name: '鉻', english: 'Chromium', number: 24, period: 4, group: 6, classification: 'transition-metal', state: 'solid', uses: '不鏽鋼、電鍍、皮革鞣製', row: 3, col: 5},
            {symbol: 'Mn', name: '錳', english: 'Manganese', number: 25, period: 4, group: 7, classification: 'transition-metal', state: 'solid', uses: '鋼鐵製造、電池、顏料', row: 3, col: 6},
            {symbol: 'Fe', name: '鐵', english: 'Iron', number: 26, period: 4, group: 8, classification: 'transition-metal', state: 'solid', uses: '鋼鐵、血紅蛋白、建築', row: 3, col: 7},
            {symbol: 'Co', name: '鈷', english: 'Cobalt', number: 27, period: 4, group: 9, classification: 'transition-metal', state: 'solid', uses: '磁鐵、電池、藍色顏料', row: 3, col: 8},
            {symbol: 'Ni', name: '鎳', english: 'Nickel', number: 28, period: 4, group: 10, classification: 'transition-metal', state: 'solid', uses: '硬幣、不鏽鋼、電池', row: 3, col: 9},
            {symbol: 'Cu', name: '銅', english: 'Copper', number: 29, period: 4, group: 11, classification: 'transition-metal', state: 'solid', uses: '電線、硬幣、水管', row: 3, col: 10},
            {symbol: 'Zn', name: '鋅', english: 'Zinc', number: 30, period: 4, group: 12, classification: 'transition-metal', state: 'solid', uses: '電池、防鏽塗層、營養補充', row: 3, col: 11},
            {symbol: 'Ga', name: '鎵', number: 31, period: 4, group: 13, classification: 'post-transition', state: 'solid', uses: '半導體、LED、溫度計', row: 3, col: 12},
            {symbol: 'Ge', name: '鍺', number: 32, period: 4, group: 14, classification: 'metalloid', state: 'solid', uses: '半導體、光纖、紅外線探測器', row: 3, col: 13},
            {symbol: 'As', name: '砷', number: 33, period: 4, group: 15, classification: 'metalloid', state: 'solid', uses: '半導體、殺蟲劑、合金', row: 3, col: 14},
            {symbol: 'Se', name: '硒', number: 34, period: 4, group: 16, classification: 'reactive-nonmetal', state: 'solid', uses: '光電池、營養補充、玻璃脫色', row: 3, col: 15},
            {symbol: 'Br', name: '溴', number: 35, period: 4, group: 17, classification: 'reactive-nonmetal', state: 'liquid', uses: '消毒劑、阻燃劑、攝影', row: 3, col: 16},
            {symbol: 'Kr', name: '氪', number: 36, period: 4, group: 18, classification: 'noble-gas', state: 'gas', uses: '雷射、高效燈泡、窗戶隔熱', row: 3, col: 17},
            
            // 第5週期
            {symbol: 'Rb', name: '銣', number: 37, period: 5, group: 1, classification: 'alkali-metal', state: 'solid', uses: '原子鐘、光電管', row: 4, col: 0},
            {symbol: 'Sr', name: '鍶', number: 38, period: 5, group: 2, classification: 'alkaline-earth', state: 'solid', uses: '煙火、信號彈、醫療同位素', row: 4, col: 1},
            {symbol: 'Y', name: '釔', number: 39, period: 5, group: 3, classification: 'transition-metal', state: 'solid', uses: '雷射、超導體、合金', row: 4, col: 2},
            {symbol: 'Zr', name: '鋯', number: 40, period: 5, group: 4, classification: 'transition-metal', state: 'solid', uses: '核反應器、陶瓷、珠寶', row: 4, col: 3},
            {symbol: 'Nb', name: '鈮', number: 41, period: 5, group: 5, classification: 'transition-metal', state: 'solid', uses: '超導體、鋼鐵合金', row: 4, col: 4},
            {symbol: 'Mo', name: '鉬', number: 42, period: 5, group: 6, classification: 'transition-metal', state: 'solid', uses: '鋼鐵合金、潤滑劑、催化劑', row: 4, col: 5},
            {symbol: 'Tc', name: '鎝', number: 43, period: 5, group: 7, classification: 'transition-metal', state: 'solid', uses: '醫療影像、防腐劑', row: 4, col: 6},
            {symbol: 'Ru', name: '釕', number: 44, period: 5, group: 8, classification: 'transition-metal', state: 'solid', uses: '催化劑、電子元件', row: 4, col: 7},
            {symbol: 'Rh', name: '銠', number: 45, period: 5, group: 9, classification: 'transition-metal', state: 'solid', uses: '催化劑、珠寶、鏡面', row: 4, col: 8},
            {symbol: 'Pd', name: '鈀', number: 46, period: 5, group: 10, classification: 'transition-metal', state: 'solid', uses: '催化劑、珠寶、牙科', row: 4, col: 9},
            {symbol: 'Ag', name: '銀', number: 47, period: 5, group: 11, classification: 'transition-metal', state: 'solid', uses: '珠寶、抗菌材料、攝影', row: 4, col: 10},
            {symbol: 'Cd', name: '鎘', number: 48, period: 5, group: 12, classification: 'transition-metal', state: 'solid', uses: '電池、顏料、電鍍', row: 4, col: 11},
            {symbol: 'In', name: '銦', number: 49, period: 5, group: 13, classification: 'post-transition', state: 'solid', uses: '觸控螢幕、LED、合金', row: 4, col: 12},
            {symbol: 'Sn', name: '錫', number: 50, period: 5, group: 14, classification: 'post-transition', state: 'solid', uses: '焊接、罐頭、合金', row: 4, col: 13},
            {symbol: 'Sb', name: '銻', number: 51, period: 5, group: 15, classification: 'metalloid', state: 'solid', uses: '阻燃劑、合金、半導體', row: 4, col: 14},
            {symbol: 'Te', name: '碲', number: 52, period: 5, group: 16, classification: 'metalloid', state: 'solid', uses: '合金、太陽能板、光碟', row: 4, col: 15},
            {symbol: 'I', name: '碘', number: 53, period: 5, group: 17, classification: 'reactive-nonmetal', state: 'solid', uses: '消毒劑、甲狀腺激素、攝影', row: 4, col: 16},
            {symbol: 'Xe', name: '氙', number: 54, period: 5, group: 18, classification: 'noble-gas', state: 'gas', uses: '汽車頭燈、麻醉劑、離子推進器', row: 4, col: 17},
            
            // 第6週期
            {symbol: 'Cs', name: '銫', number: 55, period: 6, group: 1, classification: 'alkali-metal', state: 'solid', uses: '原子鐘、光電管、鑽井', row: 5, col: 0},
            {symbol: 'Ba', name: '鋇', number: 56, period: 6, group: 2, classification: 'alkaline-earth', state: 'solid', uses: 'X光造影、煙火、鑽井泥漿', row: 5, col: 1},
            {symbol: 'La', name: '鑭', number: 57, period: 6, group: 3, classification: 'lanthanide', state: 'solid', uses: '催化劑、光學玻璃、電池', row: 8, col: 3},
            {symbol: 'Ce', name: '鈰', number: 58, period: 6, group: 3, classification: 'lanthanide', state: 'solid', uses: '催化劑、打火石、拋光粉', row: 8, col: 4},
            {symbol: 'Pr', name: '鐠', number: 59, period: 6, group: 3, classification: 'lanthanide', state: 'solid', uses: '磁鐵、合金、玻璃著色', row: 8, col: 5},
            {symbol: 'Nd', name: '釹', number: 60, period: 6, group: 3, classification: 'lanthanide', state: 'solid', uses: '強力磁鐵、雷射、玻璃著色', row: 8, col: 6},
            {symbol: 'Pm', name: '鉕', number: 61, period: 6, group: 3, classification: 'lanthanide', state: 'solid', uses: '核電池、發光塗料', row: 8, col: 7},
            {symbol: 'Sm', name: '釤', number: 62, period: 6, group: 3, classification: 'lanthanide', state: 'solid', uses: '磁鐵、核反應器、癌症治療', row: 8, col: 8},
            {symbol: 'Eu', name: '銪', number: 63, period: 6, group: 3, classification: 'lanthanide', state: 'solid', uses: '螢光燈、電視螢幕、防偽', row: 8, col: 9},
            {symbol: 'Gd', name: '釓', number: 64, period: 6, group: 3, classification: 'lanthanide', state: 'solid', uses: 'MRI造影、核反應器、磁鐵', row: 8, col: 10},
            {symbol: 'Tb', name: '鋱', number: 65, period: 6, group: 3, classification: 'lanthanide', state: 'solid', uses: '螢光燈、磁鐵、雷射', row: 8, col: 11},
            {symbol: 'Dy', name: '鏑', number: 66, period: 6, group: 3, classification: 'lanthanide', state: 'solid', uses: '磁鐵、核反應器控制棒', row: 8, col: 12},
            {symbol: 'Ho', name: '鈥', number: 67, period: 6, group: 3, classification: 'lanthanide', state: 'solid', uses: '磁鐵、雷射、醫療', row: 8, col: 13},
            {symbol: 'Er', name: '鉺', number: 68, period: 6, group: 3, classification: 'lanthanide', state: 'solid', uses: '光纖放大器、雷射、合金', row: 8, col: 14},
            {symbol: 'Tm', name: '銩', number: 69, period: 6, group: 3, classification: 'lanthanide', state: 'solid', uses: 'X光機、雷射', row: 8, col: 15},
            {symbol: 'Yb', name: '鐿', number: 70, period: 6, group: 3, classification: 'lanthanide', state: 'solid', uses: '雷射、合金、原子鐘', row: 8, col: 16},
            {symbol: 'Lu', name: '鎦', number: 71, period: 6, group: 3, classification: 'lanthanide', state: 'solid', uses: 'PET掃描、催化劑', row: 8, col: 17},
            {symbol: 'Hf', name: '鉿', number: 72, period: 6, group: 4, classification: 'transition-metal', state: 'solid', uses: '核反應器、超合金', row: 5, col: 3},
            {symbol: 'Ta', name: '鉭', number: 73, period: 6, group: 5, classification: 'transition-metal', state: 'solid', uses: '電容器、手術器械、超合金', row: 5, col: 4},
            {symbol: 'W', name: '鎢', number: 74, period: 6, group: 6, classification: 'transition-metal', state: 'solid', uses: '燈泡燈絲、鑽頭、X光管', row: 5, col: 5},
            {symbol: 'Re', name: '錸', number: 75, period: 6, group: 7, classification: 'transition-metal', state: 'solid', uses: '催化劑、超合金、溫度計', row: 5, col: 6},
            {symbol: 'Os', name: '鋨', number: 76, period: 6, group: 8, classification: 'transition-metal', state: 'solid', uses: '筆尖、電接點、催化劑', row: 5, col: 7},
            {symbol: 'Ir', name: '銥', number: 77, period: 6, group: 9, classification: 'transition-metal', state: 'solid', uses: '火星塞、坩堝、標準重量', row: 5, col: 8},
            {symbol: 'Pt', name: '鉑', number: 78, period: 6, group: 10, classification: 'transition-metal', state: 'solid', uses: '催化劑、珠寶、化療藥物', row: 5, col: 9},
            {symbol: 'Au', name: '金', number: 79, period: 6, group: 11, classification: 'transition-metal', state: 'solid', uses: '珠寶、電子元件、牙科', row: 5, col: 10},
            {symbol: 'Hg', name: '汞', number: 80, period: 6, group: 12, classification: 'transition-metal', state: 'liquid', uses: '溫度計、節能燈泡、牙科填料', row: 5, col: 11},
            {symbol: 'Tl', name: '鉈', number: 81, period: 6, group: 13, classification: 'post-transition', state: 'solid', uses: '電子元件、玻璃、殺鼠劑', row: 5, col: 12},
            {symbol: 'Pb', name: '鉛', number: 82, period: 6, group: 14, classification: 'post-transition', state: 'solid', uses: '電池、輻射防護、水管', row: 5, col: 13},
            {symbol: 'Bi', name: '鉍', number: 83, period: 6, group: 15, classification: 'post-transition', state: 'solid', uses: '合金、化妝品、醫藥', row: 5, col: 14},
            {symbol: 'Po', name: '釙', number: 84, period: 6, group: 16, classification: 'post-transition', state: 'solid', uses: '核電池、抗靜電刷', row: 5, col: 15},
            {symbol: 'At', name: '砈', number: 85, period: 6, group: 17, classification: 'metalloid', state: 'solid', uses: '癌症治療研究', row: 5, col: 16},
            {symbol: 'Rn', name: '氡', number: 86, period: 6, group: 18, classification: 'noble-gas', state: 'gas', uses: '放射性治療、地震預測', row: 5, col: 17},
            
            // 第7週期
            {symbol: 'Fr', name: '鍅', number: 87, period: 7, group: 1, classification: 'alkali-metal', state: 'solid', uses: '科學研究', row: 6, col: 0},
            {symbol: 'Ra', name: '鐳', number: 88, period: 7, group: 2, classification: 'alkaline-earth', state: 'solid', uses: '癌症治療、發光塗料', row: 6, col: 1},
            {symbol: 'Ac', name: '錒', number: 89, period: 7, group: 3, classification: 'actinide', state: 'solid', uses: '中子源、癌症治療', row: 9, col: 3},
            {symbol: 'Th', name: '釷', number: 90, period: 7, group: 3, classification: 'actinide', state: 'solid', uses: '核燃料、燈罩、合金', row: 9, col: 4},
            {symbol: 'Pa', name: '鏷', number: 91, period: 7, group: 3, classification: 'actinide', state: 'solid', uses: '科學研究', row: 9, col: 5},
            {symbol: 'U', name: '鈾', number: 92, period: 7, group: 3, classification: 'actinide', state: 'solid', uses: '核燃料、核武器、玻璃著色', row: 9, col: 6},
            {symbol: 'Np', name: '錼', number: 93, period: 7, group: 3, classification: 'actinide', state: 'solid', uses: '核反應器、探測器', row: 9, col: 7},
            {symbol: 'Pu', name: '鈽', number: 94, period: 7, group: 3, classification: 'actinide', state: 'solid', uses: '核燃料、核武器、太空電池', row: 9, col: 8},
            {symbol: 'Am', name: '鋂', number: 95, period: 7, group: 3, classification: 'actinide', state: 'solid', uses: '煙霧探測器、中子源', row: 9, col: 9},
            {symbol: 'Cm', name: '鋦', number: 96, period: 7, group: 3, classification: 'actinide', state: 'solid', uses: '太空探測器電源、科學研究', row: 9, col: 10},
            {symbol: 'Bk', name: '錇', number: 97, period: 7, group: 3, classification: 'actinide', state: 'solid', uses: '科學研究', row: 9, col: 11},
            {symbol: 'Cf', name: '鐦', number: 98, period: 7, group: 3, classification: 'actinide', state: 'solid', uses: '中子源、癌症治療', row: 9, col: 12},
            {symbol: 'Es', name: '鑀', number: 99, period: 7, group: 3, classification: 'actinide', state: 'solid', uses: '科學研究', row: 9, col: 13},
            {symbol: 'Fm', name: '鐨', number: 100, period: 7, group: 3, classification: 'actinide', state: 'solid', uses: '科學研究', row: 9, col: 14},
            {symbol: 'Md', name: '鍆', number: 101, period: 7, group: 3, classification: 'actinide', state: 'solid', uses: '科學研究', row: 9, col: 15},
            {symbol: 'No', name: '鍩', number: 102, period: 7, group: 3, classification: 'actinide', state: 'solid', uses: '科學研究', row: 9, col: 16},
            {symbol: 'Lr', name: '鐒', number: 103, period: 7, group: 3, classification: 'actinide', state: 'solid', uses: '科學研究', row: 9, col: 17},
            {symbol: 'Rf', name: '鑪', number: 104, period: 7, group: 4, classification: 'transition-metal', state: 'solid', uses: '科學研究', row: 6, col: 3},
            {symbol: 'Db', name: '𨧀', number: 105, period: 7, group: 5, classification: 'transition-metal', state: 'solid', uses: '科學研究', row: 6, col: 4},
            {symbol: 'Sg', name: '𨭎', number: 106, period: 7, group: 6, classification: 'transition-metal', state: 'solid', uses: '科學研究', row: 6, col: 5},
            {symbol: 'Bh', name: '𨨏', number: 107, period: 7, group: 7, classification: 'transition-metal', state: 'solid', uses: '科學研究', row: 6, col: 6},
            {symbol: 'Hs', name: '𨭆', number: 108, period: 7, group: 8, classification: 'transition-metal', state: 'solid', uses: '科學研究', row: 6, col: 7},
            {symbol: 'Mt', name: '鿏', number: 109, period: 7, group: 9, classification: 'unknown', state: 'solid', uses: '科學研究', row: 6, col: 8},
            {symbol: 'Ds', name: '𨭎', number: 110, period: 7, group: 10, classification: 'unknown', state: 'solid', uses: '科學研究', row: 6, col: 9},
            {symbol: 'Rg', name: '錀', number: 111, period: 7, group: 11, classification: 'unknown', state: 'solid', uses: '科學研究', row: 6, col: 10},
            {symbol: 'Cn', name: '鎶', number: 112, period: 7, group: 12, classification: 'transition-metal', state: 'solid', uses: '科學研究', row: 6, col: 11},
            {symbol: 'Nh', name: '鉨', number: 113, period: 7, group: 13, classification: 'unknown', state: 'solid', uses: '科學研究', row: 6, col: 12},
            {symbol: 'Fl', name: '鈇', number: 114, period: 7, group: 14, classification: 'unknown', state: 'solid', uses: '科學研究', row: 6, col: 13},
            {symbol: 'Mc', name: '鏌', number: 115, period: 7, group: 15, classification: 'unknown', state: 'solid', uses: '科學研究', row: 6, col: 14},
            {symbol: 'Lv', name: '鉝', number: 116, period: 7, group: 16, classification: 'unknown', state: 'solid', uses: '科學研究', row: 6, col: 15},
            {symbol: 'Ts', name: '鿬', number: 117, period: 7, group: 17, classification: 'unknown', state: 'solid', uses: '科學研究', row: 6, col: 16},
            {symbol: 'Og', name: '鿫', number: 118, period: 7, group: 18, classification: 'unknown', state: 'gas', uses: '科學研究', row: 6, col: 17}
        ];

        let currentQuiz = null;
        let quizScore = 0;
        let quizTotal = 0;
        let currentLevel = 0;
        let currentQuestion = 0;
        let levelQuestions = [];
        let wrongAnswers = [];
        let isRetryMode = false;

        // 密室逃脫關卡設計
        const escapeRoomLevels = [
            {
                level: 1,
                title: '🔬 元素符號密碼室',
                story: '你被困在化學實驗室！牆上顯示著元素符號（如H、Li、Na），你需要找到對應的中文名稱才能解開密碼鎖！',
                type: 'symbol-to-chinese'
            },
            {
                level: 2,
                title: '🀄 中文解碼室',
                story: '進入第二個房間，這次牆上顯示的是中文元素名稱，你需要找出對應的元素符號來開啟下一道門！',
                type: 'chinese-to-symbol'
            },
            {
                level: 3,
                title: '🔥 鹼金屬分類室',
                story: '你來到元素分類實驗室！需要將鹼金屬元素拖曳到正確的分類區域才能通過！',
                type: 'drag-classification',
                targetClassification: 'alkali-metal',
                elements: ['H', 'Li', 'He', 'Na', 'Ca', 'K', 'Mg', 'Rb', 'Cs', 'Fr']
            },
            {
                level: 4,
                title: '🦴 鹼土金屬分類室',
                story: '骨骼實驗室中，你需要識別出所有的鹼土金屬元素！',
                type: 'drag-classification',
                targetClassification: 'alkaline-earth',
                elements: ['Li', 'Be', 'Na', 'Mg', 'Al', 'Ca', 'Si', 'Sr', 'Ba', 'Ra']
            },
            {
                level: 5,
                title: '⚔️ 過渡金屬分類室',
                story: '金屬工坊中，找出所有的過渡金屬元素來鍛造通關鑰匙！',
                type: 'drag-classification',
                targetClassification: 'transition-metal',
                elements: ['Al', 'Fe', 'Si', 'Cu', 'Zn', 'P', 'Ag', 'Au', 'Pt', 'Ti']
            },
            {
                level: 6,
                title: '🎈 惰性氣體分類室',
                story: '氣球工廠中，選出所有安全的惰性氣體來充氣逃生！',
                type: 'drag-classification',
                targetClassification: 'noble-gas',
                elements: ['H', 'He', 'N', 'Ne', 'O', 'Ar', 'Cl', 'Kr', 'Xe', 'Rn']
            },
            {
                level: 7,
                title: '🔬 類金屬分類室',
                story: '半導體實驗室中，找出所有具有類金屬性質的元素！',
                type: 'drag-classification',
                targetClassification: 'metalloid',
                elements: ['C', 'B', 'Al', 'Si', 'P', 'Ge', 'As', 'Sb', 'Te', 'At']
            },
            {
                level: 8,
                title: '💨 活性非金屬分類室',
                story: '化學反應室中，識別出所有活性非金屬元素來完成實驗！',
                type: 'drag-classification',
                targetClassification: 'reactive-nonmetal',
                elements: ['He', 'H', 'Ne', 'C', 'N', 'O', 'F', 'P', 'S', 'Cl']
            },
            {
                level: 9,
                title: '🏭 後過渡金屬分類室',
                story: '工業區中，找出所有後過渡金屬元素來修復機器！',
                type: 'drag-classification',
                targetClassification: 'post-transition',
                elements: ['Fe', 'Al', 'Cu', 'Ga', 'In', 'Sn', 'Tl', 'Pb', 'Bi', 'Po']
            },
            {
                level: 10,
                title: '🌟 鑭系元素分類室',
                story: '稀土元素庫房中，識別出所有鑭系元素來解鎖寶庫！',
                type: 'drag-classification',
                targetClassification: 'lanthanide',
                elements: ['Ac', 'La', 'Th', 'Ce', 'Pr', 'Nd', 'Pm', 'Sm', 'Eu', 'Gd']
            },
            {
                level: 11,
                title: '☢️ 錒系元素分類室',
                story: '放射性實驗室中，小心地識別出所有錒系元素！',
                type: 'drag-classification',
                targetClassification: 'actinide',
                elements: ['La', 'Ac', 'Ce', 'Th', 'Pa', 'U', 'Np', 'Pu', 'Am', 'Cm']
            },
            {
                level: 12,
                title: '🏆 終極挑戰：未知元素',
                story: '最後的挑戰！找出所有性質未知的超重元素，證明你是真正的元素大師！',
                type: 'drag-classification',
                targetClassification: 'unknown',
                elements: ['Cn', 'Mt', 'Ds', 'Rg', 'Nh', 'Fl', 'Mc', 'Lv', 'Ts', 'Og']
            }
        ];

        function createPeriodicTable() {
            const table = document.getElementById('periodicTable');
            table.innerHTML = '';
            
            // 創建10x18的網格（包含鑭系和錒系）
            for (let i = 0; i < 10 * 18; i++) {
                const cell = document.createElement('div');
                cell.className = 'element empty';
                table.appendChild(cell);
            }
            
            // 填入元素
            elements.forEach(element => {
                const index = element.row * 18 + element.col;
                const cell = table.children[index];
                
                cell.className = `element ${element.classification}`;
                cell.innerHTML = `
                    <div class="atomic-number">${element.number}</div>
                    <div class="symbol">${element.symbol}</div>
                    <div class="name">${element.name}</div>
                `;
                
                cell.onclick = () => showElementInfo(element);
            });
        }

        function createStats() {
            const stats = document.getElementById('stats');
            const classifications = {};
            const states = {solid: 0, liquid: 0, gas: 0};
            
            elements.forEach(element => {
                classifications[element.classification] = (classifications[element.classification] || 0) + 1;
                states[element.state]++;
            });
            
            stats.innerHTML = `
                <div class="stat-item">
                    <div class="stat-number">118</div>
                    <div class="stat-label">總元素數</div>
                </div>
                <div class="stat-item">
                    <div class="stat-number">${states.solid}</div>
                    <div class="stat-label">固體元素</div>
                </div>
                <div class="stat-item">
                    <div class="stat-number">${states.liquid}</div>
                    <div class="stat-label">液體元素</div>
                </div>
                <div class="stat-item">
                    <div class="stat-number">${states.gas}</div>
                    <div class="stat-label">氣體元素</div>
                </div>
                <div class="stat-item">
                    <div class="stat-number">${classifications['transition-metal'] || 0}</div>
                    <div class="stat-label">過渡金屬</div>
                </div>
                <div class="stat-item">
                    <div class="stat-number">${classifications['reactive-nonmetal'] || 0}</div>
                    <div class="stat-label">活性非金屬</div>
                </div>
            `;
        }

        function showElementInfo(element) {
            const panel = document.getElementById('infoPanel');
            const overlay = document.getElementById('overlay');
            const info = document.getElementById('elementInfo');
            
            info.innerHTML = `
                <h2 style="color: #333; margin-bottom: 20px; text-align: center;">
                    ${element.name} (${element.symbol})
                </h2>
                <div style="display: grid; gap: 15px;">
                    <div><strong>原子序：</strong>${element.number}</div>
                    <div><strong>週期：</strong>${element.period}</div>
                    <div><strong>族：</strong>${element.group}</div>
                    <div><strong>狀態：</strong>${element.state === 'solid' ? '固體' : element.state === 'liquid' ? '液體' : '氣體'}</div>
                    <div><strong>分類：</strong>${getClassificationName(element.classification)}</div>
                    <div style="background: #f8f9fa; padding: 15px; border-radius: 8px;">
                        <strong>生活應用：</strong><br>
                        ${element.uses}
                    </div>
                </div>
            `;
            
            panel.classList.add('show');
            overlay.classList.add('show');
        }

        function getClassificationName(classification) {
            const names = {
                'alkali-metal': '鹼金屬',
                'alkaline-earth': '鹼土金屬',
                'transition-metal': '過渡金屬',
                'post-transition': '後過渡金屬',
                'metalloid': '類金屬',
                'reactive-nonmetal': '活性非金屬',
                'noble-gas': '惰性氣體',
                'lanthanide': '鑭系元素',
                'actinide': '錒系元素',
                'unknown': '未知性質'
            };
            return names[classification] || classification;
        }

        function closePanel() {
            document.getElementById('infoPanel').classList.remove('show');
            document.getElementById('overlay').classList.remove('show');
        }

        function startQuiz() {
            currentQuiz = escapeRoomLevels;
            quizScore = 0;
            quizTotal = currentQuiz.length;
            currentLevel = 0;
            currentQuestion = 0;
            levelQuestions = [];
            wrongAnswers = [];
            isRetryMode = false;
            
            document.getElementById('quizPanel').classList.add('show');
            document.getElementById('overlay').classList.add('show');
            
            startLevel();
        }

        function startLevel() {
            if (currentLevel >= currentQuiz.length) {
                finishEscape();
                return;
            }
            
            const level = currentQuiz[currentLevel];
            
            // 初始化關卡
            if (level.type === 'symbol-to-chinese' || level.type === 'chinese-to-symbol') {
                levelQuestions = generateRandomQuestions(level.type);
            }
            
            currentQuestion = 0;
            wrongAnswers = [];
            isRetryMode = false;
            
            showQuestion();
        }
        
        function generateRandomQuestions(type) {
            // 從前30個常見元素中隨機選擇10個不重複的元素
            const commonElements = elements.slice(0, 30); // 選擇前30個常見元素
            const selectedElements = [];
            const usedIndices = new Set();
            
            while (selectedElements.length < 10 && usedIndices.size < commonElements.length) {
                const randomIndex = Math.floor(Math.random() * commonElements.length);
                if (!usedIndices.has(randomIndex)) {
                    usedIndices.add(randomIndex);
                    selectedElements.push(commonElements[randomIndex]);
                }
            }
            
            return selectedElements.map(element => {
                if (type === 'symbol-to-chinese') {
                    // 生成3個錯誤選項
                    const wrongOptions = getRandomWrongOptions(element.name, 'chinese');
                    const allOptions = [element.name, ...wrongOptions];
                    shuffleArray(allOptions);
                    
                    return {
                        question: element.symbol,
                        answers: allOptions,
                        correct: element.name
                    };
                } else if (type === 'chinese-to-symbol') {
                    // 生成3個錯誤選項
                    const wrongOptions = getRandomWrongOptions(element.symbol, 'symbol');
                    const allOptions = [element.symbol, ...wrongOptions];
                    shuffleArray(allOptions);
                    
                    return {
                        question: element.name,
                        answers: allOptions,
                        correct: element.symbol
                    };
                }
            });
        }
        
        function getRandomWrongOptions(correctAnswer, type) {
            const wrongOptions = [];
            let availableElements;
            
            if (type === 'chinese') {
                availableElements = elements.filter(el => el.name !== correctAnswer);
            } else if (type === 'symbol') {
                availableElements = elements.filter(el => el.symbol !== correctAnswer);
            }
            
            while (wrongOptions.length < 3 && wrongOptions.length < availableElements.length) {
                const randomElement = availableElements[Math.floor(Math.random() * availableElements.length)];
                const option = type === 'chinese' ? randomElement.name : randomElement.symbol;
                
                if (!wrongOptions.includes(option)) {
                    wrongOptions.push(option);
                }
            }
            
            return wrongOptions;
        }
        
        function showQuestion() {
            const level = currentQuiz[currentLevel];
            
            document.getElementById('quizScore').textContent = `關卡：${currentLevel + 1} / ${quizTotal} | 題目：${currentQuestion + 1} / 10`;
            document.getElementById('levelTitle').textContent = level.title;
            document.getElementById('storyText').textContent = level.story;
            document.getElementById('quizFeedback').style.display = 'none';
            document.getElementById('nextBtn').style.display = 'none';
            document.getElementById('finishBtn').style.display = 'none';
            
            const answerContainer = document.getElementById('answerButtons');
            answerContainer.innerHTML = '';
            
            if (level.type === 'symbol-to-chinese' || level.type === 'chinese-to-symbol') {
                showMultipleChoiceQuestion(level);
            } else if (level.type === 'drag-classification') {
                showDragClassificationQuestion(level);
            }
        }
        
        function showMultipleChoiceQuestion(level) {
            let questionData;
            
            if (isRetryMode && wrongAnswers.length > 0) {
                questionData = wrongAnswers[currentQuestion];
                document.getElementById('quizQuestion').textContent = `重做題目：${questionData.question}`;
            } else {
                questionData = levelQuestions[currentQuestion];
                document.getElementById('quizQuestion').textContent = questionData.question;
            }
            
            // 隨機排列答案選項
            const shuffledAnswers = [...questionData.answers];
            shuffleArray(shuffledAnswers);
            
            const answerContainer = document.getElementById('answerButtons');
            answerContainer.style.display = 'grid';
            answerContainer.style.gridTemplateColumns = '1fr 1fr';
            
            shuffledAnswers.forEach(answer => {
                const button = document.createElement('button');
                button.textContent = answer;
                button.style.cssText = `
                    padding: 15px;
                    border: 2px solid #ffd700;
                    border-radius: 8px;
                    background: rgba(255,255,255,0.1);
                    color: white;
                    font-size: 1.1rem;
                    font-weight: bold;
                    cursor: pointer;
                    transition: all 0.3s ease;
                `;
                button.onmouseover = () => {
                    button.style.background = 'rgba(255,215,0,0.3)';
                    button.style.transform = 'scale(1.05)';
                };
                button.onmouseout = () => {
                    button.style.background = 'rgba(255,255,255,0.1)';
                    button.style.transform = 'scale(1)';
                };
                button.onclick = () => checkMultipleChoiceAnswer(answer, questionData);
                answerContainer.appendChild(button);
            });
        }
        
        function showDragClassificationQuestion(level) {
            document.getElementById('quizQuestion').textContent = `將屬於「${getClassificationName(level.targetClassification)}」的元素拖曳到下方區域`;
            
            const answerContainer = document.getElementById('answerButtons');
            answerContainer.style.display = 'block';
            answerContainer.innerHTML = `
                <div style="margin-bottom: 20px;">
                    <h4 style="color: #ffd700; margin-bottom: 10px;">可選元素：</h4>
                    <div id="elementPool" style="display: flex; flex-wrap: wrap; gap: 10px; padding: 15px; background: rgba(255,255,255,0.1); border-radius: 8px; min-height: 80px;">
                        ${level.elements.map(symbol => `
                            <div class="draggable-element" draggable="true" data-symbol="${symbol}" 
                                 style="padding: 8px 12px; background: rgba(255,215,0,0.8); color: #1e3c72; border-radius: 5px; cursor: move; font-weight: bold;">
                                ${symbol}
                            </div>
                        `).join('')}
                    </div>
                </div>
                <div>
                    <h4 style="color: #ffd700; margin-bottom: 10px;">${getClassificationName(level.targetClassification)}區域：</h4>
                    <div id="dropZone" style="min-height: 100px; padding: 15px; background: rgba(0,255,0,0.1); border: 2px dashed #ffd700; border-radius: 8px; display: flex; flex-wrap: wrap; gap: 10px;">
                        <span style="color: #ccc; align-self: center;">將正確的元素拖曳到這裡</span>
                    </div>
                </div>
                <button id="checkClassification" onclick="checkClassificationAnswer()" 
                        style="margin-top: 15px; padding: 10px 20px; background: #28a745; color: white; border: none; border-radius: 5px; cursor: pointer;">
                    檢查答案
                </button>
            `;
            
            setupDragAndDrop();
            highlightClassification(level.targetClassification);
        }

        function highlightClassification(classification) {
            document.querySelectorAll('.element').forEach(el => {
                el.classList.remove('selected');
                if (!el.classList.contains('empty')) {
                    const symbol = el.querySelector('.symbol')?.textContent;
                    const elementData = elements.find(e => e.symbol === symbol);
                    if (elementData && elementData.classification === classification) {
                        el.style.boxShadow = '0 0 15px #ffd700';
                        el.style.borderColor = '#ffd700';
                    } else {
                        el.style.boxShadow = '';
                        el.style.borderColor = '#ddd';
                    }
                }
            });
        }

        function checkMultipleChoiceAnswer(selectedAnswer, questionData) {
            const feedback = document.getElementById('quizFeedback');
            const answerButtons = document.querySelectorAll('#answerButtons button');
            
            // 禁用所有按鈕
            answerButtons.forEach(btn => {
                btn.onclick = null;
                btn.style.opacity = '0.6';
            });
            
            if (selectedAnswer === questionData.correct) {
                feedback.className = 'quiz-feedback correct';
                feedback.innerHTML = `
                    <div style="text-align: center;">
                        <h3>✅ 答對了！</h3>
                        <p>正確答案：<strong>${selectedAnswer}</strong></p>
                    </div>
                `;
            } else {
                feedback.className = 'quiz-feedback incorrect';
                feedback.innerHTML = `
                    <div style="text-align: center;">
                        <h3>❌ 答錯了！</h3>
                        <p>正確答案是：<strong>${questionData.correct}</strong></p>
                    </div>
                `;
                
                // 記錄錯誤答案
                if (!isRetryMode) {
                    wrongAnswers.push(questionData);
                }
            }
            
            feedback.style.display = 'block';
            
            setTimeout(() => {
                nextQuestion();
            }, 2000);
        }
        
        function checkClassificationAnswer() {
            const level = currentQuiz[currentLevel];
            const dropZone = document.getElementById('dropZone');
            const droppedElements = Array.from(dropZone.querySelectorAll('.draggable-element')).map(el => el.dataset.symbol);
            
            // 找出正確答案
            const correctElements = elements.filter(el => el.classification === level.targetClassification).map(el => el.symbol);
            const correctInLevel = level.elements.filter(symbol => correctElements.includes(symbol));
            
            const feedback = document.getElementById('quizFeedback');
            
            // 檢查是否完全正確
            const isCorrect = droppedElements.length === correctInLevel.length && 
                             droppedElements.every(symbol => correctInLevel.includes(symbol));
            
            if (isCorrect) {
                feedback.className = 'quiz-feedback correct';
                feedback.innerHTML = `
                    <div style="text-align: center;">
                        <h3>🎉 完全正確！</h3>
                        <p>你成功識別出所有的${getClassificationName(level.targetClassification)}元素！</p>
                        <p>正確元素：${correctInLevel.join(', ')}</p>
                    </div>
                `;
                
                setTimeout(() => {
                    nextLevel();
                }, 3000);
            } else {
                feedback.className = 'quiz-feedback incorrect';
                feedback.innerHTML = `
                    <div style="text-align: center;">
                        <h3>❌ 還有錯誤！</h3>
                        <p>請重新檢查你的選擇</p>
                        <p>正確的${getClassificationName(level.targetClassification)}元素應該是：${correctInLevel.join(', ')}</p>
                    </div>
                `;
            }
            
            feedback.style.display = 'block';
        }

        function nextQuestion() {
            currentQuestion++;
            
            const level = currentQuiz[currentLevel];
            
            if (level.type === 'symbol-to-chinese' || level.type === 'chinese-to-symbol') {
                // 選擇題模式
                if (!isRetryMode && currentQuestion >= 10) {
                    // 第一輪10題完成，開始重做錯題
                    if (wrongAnswers.length > 0) {
                        isRetryMode = true;
                        currentQuestion = 0;
                        document.getElementById('quizFeedback').innerHTML = `
                            <div style="text-align: center;">
                                <h3>📝 開始重做錯題</h3>
                                <p>你需要重做 ${wrongAnswers.length} 道錯題</p>
                            </div>
                        `;
                        setTimeout(() => {
                            showQuestion();
                        }, 2000);
                        return;
                    } else {
                        // 沒有錯題，直接進入下一關
                        nextLevel();
                        return;
                    }
                } else if (isRetryMode && currentQuestion >= wrongAnswers.length) {
                    // 重做模式完成
                    nextLevel();
                    return;
                }
            }
            
            showQuestion();
        }
        
        function nextLevel() {
            currentLevel++;
            quizScore++;
            
            if (currentLevel >= currentQuiz.length) {
                finishEscape();
                return;
            }
            
            // 顯示關卡完成訊息
            const feedback = document.getElementById('quizFeedback');
            feedback.className = 'quiz-feedback correct';
            feedback.innerHTML = `
                <div style="text-align: center;">
                    <h3>🎉 關卡完成！</h3>
                    <p>準備進入下一關...</p>
                </div>
            `;
            feedback.style.display = 'block';
            
            setTimeout(() => {
                startLevel();
            }, 2000);
        }

        function shuffleArray(array) {
            for (let i = array.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [array[i], array[j]] = [array[j], array[i]];
            }
        }
        
        function setupDragAndDrop() {
            const draggableElements = document.querySelectorAll('.draggable-element');
            const dropZone = document.getElementById('dropZone');
            const elementPool = document.getElementById('elementPool');
            
            let draggedElement = null;
            let touchOffset = { x: 0, y: 0 };
            
            draggableElements.forEach(element => {
                // 桌面拖曳事件
                element.addEventListener('dragstart', (e) => {
                    e.dataTransfer.setData('text/plain', e.target.dataset.symbol);
                    e.target.style.opacity = '0.5';
                    draggedElement = e.target;
                });
                
                element.addEventListener('dragend', (e) => {
                    e.target.style.opacity = '1';
                    draggedElement = null;
                });
                
                // 手機觸控事件
                element.addEventListener('touchstart', (e) => {
                    e.preventDefault();
                    draggedElement = e.target;
                    const touch = e.touches[0];
                    const rect = element.getBoundingClientRect();
                    touchOffset.x = touch.clientX - rect.left;
                    touchOffset.y = touch.clientY - rect.top;
                    
                    element.style.opacity = '0.7';
                    element.style.transform = 'scale(1.1)';
                    element.style.zIndex = '1000';
                    element.style.position = 'fixed';
                    element.style.pointerEvents = 'none';
                    element.style.left = (touch.clientX - touchOffset.x) + 'px';
                    element.style.top = (touch.clientY - touchOffset.y) + 'px';
                });
                
                element.addEventListener('touchmove', (e) => {
                    if (!draggedElement) return;
                    e.preventDefault();
                    const touch = e.touches[0];
                    element.style.left = (touch.clientX - touchOffset.x) + 'px';
                    element.style.top = (touch.clientY - touchOffset.y) + 'px';
                    
                    // 檢查是否在放置區域上方
                    const elementBelow = document.elementFromPoint(touch.clientX, touch.clientY);
                    const dropZoneElement = elementBelow?.closest('#dropZone, #elementPool');
                    
                    // 重置所有區域背景
                    dropZone.style.background = 'rgba(0,255,0,0.1)';
                    elementPool.style.background = 'rgba(255,255,255,0.1)';
                    
                    // 高亮當前區域
                    if (dropZoneElement) {
                        dropZoneElement.style.background = dropZoneElement === dropZone ? 'rgba(0,255,0,0.3)' : 'rgba(255,255,255,0.3)';
                    }
                });
                
                element.addEventListener('touchend', (e) => {
                    if (!draggedElement) return;
                    e.preventDefault();
                    
                    const touch = e.changedTouches[0];
                    const elementBelow = document.elementFromPoint(touch.clientX, touch.clientY);
                    const targetZone = elementBelow?.closest('#dropZone, #elementPool');
                    
                    // 重置樣式
                    element.style.opacity = '1';
                    element.style.transform = 'scale(1)';
                    element.style.zIndex = 'auto';
                    element.style.position = 'static';
                    element.style.pointerEvents = 'auto';
                    element.style.left = 'auto';
                    element.style.top = 'auto';
                    
                    // 移動元素到目標區域
                    if (targetZone) {
                        const placeholder = targetZone.querySelector('span');
                        if (placeholder) placeholder.remove();
                        targetZone.appendChild(element);
                    }
                    
                    // 重置背景
                    dropZone.style.background = 'rgba(0,255,0,0.1)';
                    elementPool.style.background = 'rgba(255,255,255,0.1)';
                    
                    draggedElement = null;
                });
            });
            
            // 桌面拖放事件
            [dropZone, elementPool].forEach(zone => {
                zone.addEventListener('dragover', (e) => {
                    e.preventDefault();
                    zone.style.background = zone === dropZone ? 'rgba(0,255,0,0.2)' : 'rgba(255,255,255,0.2)';
                });
                
                zone.addEventListener('dragleave', (e) => {
                    zone.style.background = zone === dropZone ? 'rgba(0,255,0,0.1)' : 'rgba(255,255,255,0.1)';
                });
                
                zone.addEventListener('drop', (e) => {
                    e.preventDefault();
                    const symbol = e.dataTransfer.getData('text/plain');
                    const element = document.querySelector(`[data-symbol="${symbol}"]`);
                    
                    if (element) {
                        const placeholder = zone.querySelector('span');
                        if (placeholder) placeholder.remove();
                        zone.appendChild(element);
                    }
                    
                    zone.style.background = zone === dropZone ? 'rgba(0,255,0,0.1)' : 'rgba(255,255,255,0.1)';
                });
            });
        }
        
        function finishEscape() {
            const feedback = document.getElementById('quizFeedback');
            
            feedback.className = 'quiz-feedback correct';
            feedback.innerHTML = `
                <div style="text-align: center;">
                    <h2>🏆 恭喜逃脫成功！</h2>
                    <p style="font-size: 1.2rem; margin: 15px 0;">完成關卡：${quizScore} / ${quizTotal}</p>
                    <p style="font-size: 1.1rem;">🌟 你是真正的化學元素大師！</p>
                    <p>你已經掌握了化學元素的所有奧秘！</p>
                </div>
            `;
            feedback.style.display = 'block';
            
            document.getElementById('levelTitle').textContent = '🎊 密室逃脫完成！';
            document.getElementById('storyText').textContent = '';
            document.getElementById('quizQuestion').textContent = '';
            document.getElementById('answerButtons').innerHTML = '';
            document.getElementById('finishBtn').style.display = 'inline-block';
        }

        function closeQuiz() {
            document.getElementById('quizPanel').classList.remove('show');
            document.getElementById('overlay').classList.remove('show');
            
            // 恢復元素點擊功能
            elements.forEach(element => {
                const index = element.row * 18 + element.col;
                const cell = document.getElementById('periodicTable').children[index];
                if (cell && !cell.classList.contains('empty')) {
                    cell.classList.remove('selected');
                    cell.onclick = () => showElementInfo(element);
                }
            });
        }

        function showAllElements() {
            const panel = document.getElementById('infoPanel');
            const overlay = document.getElementById('overlay');
            const info = document.getElementById('elementInfo');
            
            const classifications = {
                'alkali-metal': [],
                'alkaline-earth': [],
                'transition-metal': [],
                'post-transition': [],
                'metalloid': [],
                'reactive-nonmetal': [],
                'noble-gas': [],
                'lanthanide': [],
                'actinide': [],
                'unknown': []
            };
            
            elements.forEach(element => {
                classifications[element.classification].push(element);
            });
            
            let html = '<h2 style="text-align: center; margin-bottom: 20px;">所有元素分類列表</h2>';
            
            Object.entries(classifications).forEach(([classification, elementList]) => {
                if (elementList.length > 0) {
                    html += `
                        <div style="margin-bottom: 20px;">
                            <h3 style="color: #4facfe; margin-bottom: 10px;">${getClassificationName(classification)} (${elementList.length}個)</h3>
                            <div style="display: flex; flex-wrap: wrap; gap: 8px;">
                    `;
                    
                    elementList.forEach(element => {
                        html += `<span style="background: #f8f9fa; padding: 5px 10px; border-radius: 5px; font-size: 0.9rem;">${element.symbol} ${element.name}</span>`;
                    });
                    
                    html += '</div></div>';
                }
            });
            
            info.innerHTML = html;
            panel.classList.add('show');
            overlay.classList.add('show');
        }

        // 顯示模式切換
        document.getElementById('displayMode').addEventListener('change', function() {
            const mode = this.value;
            updateDisplayMode(mode);
            updateLegend(mode);
        });

        function updateDisplayMode(mode) {
            const elementDivs = document.querySelectorAll('.element:not(.empty)');
            
            elementDivs.forEach(elementDiv => {
                const symbol = elementDiv.querySelector('.symbol')?.textContent;
                const elementData = elements.find(e => e.symbol === symbol);
                
                if (!elementData) return;
                
                // 重置樣式
                elementDiv.className = `element ${elementData.classification}`;
                
                if (mode === 'state') {
                    // 按物質狀態顯示
                    elementDiv.className = `element state-${elementData.state}`;
                } else if (mode === 'period') {
                    // 按週期顯示
                    elementDiv.className = `element period-${elementData.period}`;
                }
            });
        }

        function updateLegend(mode) {
            const legend = document.getElementById('legend');
            
            if (mode === 'classification') {
                legend.innerHTML = `
                    <div class="legend-item"><div class="legend-color alkali-metal"></div><span>鹼金屬 (6個)</span></div>
                    <div class="legend-item"><div class="legend-color alkaline-earth"></div><span>鹼土金屬 (6個)</span></div>
                    <div class="legend-item"><div class="legend-color transition-metal"></div><span>過渡金屬 (38個)</span></div>
                    <div class="legend-item"><div class="legend-color post-transition"></div><span>後過渡金屬 (7個)</span></div>
                    <div class="legend-item"><div class="legend-color metalloid"></div><span>類金屬 (7個)</span></div>
                    <div class="legend-item"><div class="legend-color reactive-nonmetal"></div><span>活性非金屬 (16個)</span></div>
                    <div class="legend-item"><div class="legend-color noble-gas"></div><span>惰性氣體 (7個)</span></div>
                    <div class="legend-item"><div class="legend-color lanthanide"></div><span>鑭系元素 (15個)</span></div>
                    <div class="legend-item"><div class="legend-color actinide"></div><span>錒系元素 (15個)</span></div>
                    <div class="legend-item"><div class="legend-color unknown"></div><span>未知性質 (1個)</span></div>
                `;
            } else if (mode === 'state') {
                legend.innerHTML = `
                    <div class="legend-item"><div class="legend-color state-solid"></div><span>固體 (84個)</span></div>
                    <div class="legend-item"><div class="legend-color state-liquid"></div><span>液體 (2個)</span></div>
                    <div class="legend-item"><div class="legend-color state-gas"></div><span>氣體 (32個)</span></div>
                `;
            } else if (mode === 'period') {
                legend.innerHTML = `
                    <div class="legend-item"><div class="legend-color period-1"></div><span>第1週期 (2個)</span></div>
                    <div class="legend-item"><div class="legend-color period-2"></div><span>第2週期 (8個)</span></div>
                    <div class="legend-item"><div class="legend-color period-3"></div><span>第3週期 (8個)</span></div>
                    <div class="legend-item"><div class="legend-color period-4"></div><span>第4週期 (18個)</span></div>
                    <div class="legend-item"><div class="legend-color period-5"></div><span>第5週期 (18個)</span></div>
                    <div class="legend-item"><div class="legend-color period-6"></div><span>第6週期 (32個)</span></div>
                    <div class="legend-item"><div class="legend-color period-7"></div><span>第7週期 (32個)</span></div>
                `;
            }
        }

        // 開發者功能
        function showCodeModal() {
            const modal = document.getElementById('codeModal');
            const overlay = document.getElementById('overlay');
            const codeContent = document.getElementById('codeContent');
            
            // 獲取完整的HTML程式碼
            const fullCode = document.documentElement.outerHTML;
            codeContent.textContent = fullCode;
            
            modal.classList.add('show');
            overlay.classList.add('show');
        }
        
        function closeCodeModal() {
            const modal = document.getElementById('codeModal');
            const overlay = document.getElementById('overlay');
            
            modal.classList.remove('show');
            overlay.classList.remove('show');
        }
        
        async function copyCode() {
            const codeContent = document.getElementById('codeContent');
            const copyBtn = document.getElementById('copyBtn');
            
            try {
                await navigator.clipboard.writeText(codeContent.textContent);
                copyBtn.textContent = '✅ 已複製！';
                copyBtn.classList.add('copied');
                
                setTimeout(() => {
                    copyBtn.textContent = '複製程式碼';
                    copyBtn.classList.remove('copied');
                }, 2000);
            } catch (err) {
                // 備用複製方法
                const textArea = document.createElement('textarea');
                textArea.value = codeContent.textContent;
                document.body.appendChild(textArea);
                textArea.select();
                document.execCommand('copy');
                document.body.removeChild(textArea);
                
                copyBtn.textContent = '✅ 已複製！';
                copyBtn.classList.add('copied');
                
                setTimeout(() => {
                    copyBtn.textContent = '複製程式碼';
                    copyBtn.classList.remove('copied');
                }, 2000);
            }
        }
        
        // 修改overlay點擊事件，避免在程式碼視窗開啟時關閉
        document.getElementById('overlay').onclick = function() {
            const codeModal = document.getElementById('codeModal');
            if (!codeModal.classList.contains('show')) {
                closePanel();
            }
        };

        // 初始化
        createPeriodicTable();
        createStats();
        updateLegend('classification');
    </script>
<script>(function(){function c(){var b=a.contentDocument||a.contentWindow.document;if(b){var d=b.createElement('script');d.innerHTML="window.__CF$cv$params={r:'95c8901e51794a51',t:'MTc1MjA3MTg4NS4wMDAwMDA='};var a=document.createElement('script');a.nonce='';a.src='/cdn-cgi/challenge-platform/scripts/jsd/main.js';document.getElementsByTagName('head')[0].appendChild(a);";b.getElementsByTagName('head')[0].appendChild(d)}}if(document.body){var a=document.createElement('iframe');a.height=1;a.width=1;a.style.position='absolute';a.style.top=0;a.style.left=0;a.style.border='none';a.style.visibility='hidden';document.body.appendChild(a);if('loading'!==document.readyState)c();else if(window.addEventListener)document.addEventListener('DOMContentLoaded',c);else{var e=document.onreadystatechange||function(){};document.onreadystatechange=function(b){e(b);'loading'!==document.readyState&&(document.onreadystatechange=e,c())}}}})();</script><iframe height="1" width="1" style="position: absolute; top: 0px; left: 0px; border: none; visibility: hidden;"></iframe>

</body></html>